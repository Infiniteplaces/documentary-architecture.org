var app=function(){"use strict";function t(){}const e=t=>t;function n(t,e){for(const n in e)t[n]=e[n];return t}function o(t){return t()}function a(){return Object.create(null)}function i(t){t.forEach(o)}function r(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e,n){if(t){const o=s(t,e,n);return t[0](o)}}function s(t,e,o){return t[1]?n({},n(e.$$scope.ctx,t[1](o?o(e):{}))):e.$$scope.ctx}function u(t,e,o,a){return t[1]?n({},n(e.$$scope.changed||{},t[1](a?a(o):{}))):e.$$scope.changed||{}}const d="undefined"!=typeof window;let p=d?()=>window.performance.now():()=>Date.now(),m=d?t=>requestAnimationFrame(t):t;const g=new Set;let f,h=!1;function v(){g.forEach(t=>{t[0](p())||(g.delete(t),t[1]())}),(h=g.size>0)&&m(v)}function $(t,e){t.appendChild(e)}function w(t,e,n){t.insertBefore(e,n||null)}function y(t){t.parentNode.removeChild(t)}function b(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function x(t){return document.createElement(t)}function T(t){return document.createTextNode(t)}function E(){return T(" ")}function R(){return T("")}function _(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function k(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function L(t,e){e=""+e,t.data!==e&&(t.data=e)}function C(t,e){(null!=e||t.value)&&(t.value=e)}function H(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=document.createElement("object");let o;return n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;"),n.type="text/html",n.tabIndex=-1,n.onload=(()=>{(o=n.contentDocument.defaultView).addEventListener("resize",e)}),/Trident/.test(navigator.userAgent)?(t.appendChild(n),n.data="about:blank"):(n.data="about:blank",t.appendChild(n)),{cancel:()=>{o&&o.removeEventListener&&o.removeEventListener("resize",e),t.removeChild(n)}}}function W(t,e,n){t.classList[n?"add":"remove"](e)}function M(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}class S{constructor(t,e=null){this.e=x("div"),this.a=e,this.u(t)}m(t,e=null){for(let n=0;n<this.n.length;n+=1)w(t,this.n[n],e);this.t=t}u(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}p(t){this.d(),this.u(t),this.m(this.t,this.a)}d(){this.n.forEach(y)}}let j,z=0,I={};function P(t,e,n,o,a,i,r,l=0){const c=16.666/o;let s="{\n";for(let t=0;t<=1;t+=c){const o=e+(n-e)*i(t);s+=100*t+`%{${r(o,1-o)}}\n`}const u=s+`100% {${r(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${l}`;if(!I[d]){if(!f){const t=x("style");document.head.appendChild(t),f=t.sheet}I[d]=!0,f.insertRule(`@keyframes ${d} ${u}`,f.cssRules.length)}const p=t.style.animation||"";return t.style.animation=`${p?`${p}, `:""}${d} ${o}ms linear ${a}ms 1 both`,z+=1,d}function q(t,e){t.style.animation=(t.style.animation||"").split(", ").filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")).join(", "),e&&!--z&&m(()=>{if(z)return;let t=f.cssRules.length;for(;t--;)f.deleteRule(t);I={}})}function A(t){j=t}function B(){if(!j)throw new Error("Function called outside component initialization");return j}function O(t){B().$$.before_update.push(t)}function F(t){B().$$.on_destroy.push(t)}function D(){const t=j;return(e,n)=>{const o=t.$$.callbacks[e];if(o){const a=M(e,n);o.slice().forEach(e=>{e.call(t,a)})}}}const N=[],G=[],V=[],U=[],J=Promise.resolve();let X,Z=!1;function K(t){V.push(t)}function Y(){const t=new Set;do{for(;N.length;){const t=N.shift();A(t),Q(t.$$)}for(;G.length;)G.pop()();for(let e=0;e<V.length;e+=1){const n=V[e];t.has(n)||(n(),t.add(n))}V.length=0}while(N.length);for(;U.length;)U.pop()();Z=!1}function Q(t){t.fragment&&(t.update(t.dirty),i(t.before_update),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_update.forEach(K))}function tt(t,e,n){t.dispatchEvent(M(`${e?"intro":"outro"}${n}`))}const et=new Set;let nt;function ot(){nt={r:0,c:[],p:nt}}function at(){nt.r||i(nt.c),nt=nt.p}function it(t,e){t&&t.i&&(et.delete(t),t.i(e))}function rt(t,e,n,o){if(t&&t.o){if(et.has(t))return;et.add(t),nt.c.push(()=>{et.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}const lt={duration:0};function ct(n,o,a,l){let c=o(n,a),s=l?0:1,u=null,d=null,f=null;function $(){f&&q(n,f)}function w(t,e){const n=t.b-s;return e*=Math.abs(n),{a:s,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function y(o){const{delay:a=0,duration:r=300,easing:l=e,tick:y=t,css:b}=c||lt,x={start:p()+a,b:o};o||(x.group=nt,nt.r+=1),u?d=x:(b&&($(),f=P(n,s,o,r,a,l,b)),o&&y(0,1),u=w(x,r),K(()=>tt(n,o,"start")),function(t){let e;h||(h=!0,m(v)),new Promise(n=>{g.add(e=[t,n])})}(t=>{if(d&&t>d.start&&(u=w(d,r),d=null,tt(n,u.b,"start"),b&&($(),f=P(n,s,u.b,u.duration,0,l,c.css))),u)if(t>=u.end)y(s=u.b,1-s),tt(n,u.b,"end"),d||(u.b?$():--u.group.r||i(u.group.c)),u=null;else if(t>=u.start){const e=t-u.start;s=u.a+u.d*l(e/u.duration),y(s,1-s)}return!(!u&&!d)}))}return{run(t){r(c)?(X||(X=Promise.resolve()).then(()=>{X=null}),X).then(()=>{c=c(),y(t)}):y(t)},end(){$(),u=d=null}}}function st(t,e,n){const{fragment:a,on_mount:l,on_destroy:c,after_update:s}=t.$$;a.m(e,n),K(()=>{const e=l.map(o).filter(r);c?c.push(...e):i(e),t.$$.on_mount=[]}),s.forEach(K)}function ut(t,e){t.$$.fragment&&(i(t.$$.on_destroy),t.$$.fragment.d(e),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={})}function dt(t,e){t.$$.dirty||(N.push(t),Z||(Z=!0,J.then(Y)),t.$$.dirty=a()),t.$$.dirty[e]=!0}function pt(e,n,o,r,l,c){const s=j;A(e);const u=n.props||{},d=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:l,bound:a(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(s?s.$$.context:[]),callbacks:a(),dirty:null};let p=!1;var m;d.ctx=o?o(e,u,(t,n,o=n)=>(d.ctx&&l(d.ctx[t],d.ctx[t]=o)&&(d.bound[t]&&d.bound[t](o),p&&dt(e,t)),n)):u,d.update(),p=!0,i(d.before_update),d.fragment=r(d.ctx),n.target&&(n.hydrate?d.fragment.l((m=n.target,Array.from(m.childNodes))):d.fragment.c(),n.intro&&it(e.$$.fragment),st(e,n.target,n.anchor),Y()),A(s)}class mt{$destroy(){ut(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function gt(t){const e=t-1;return e*e*e+1}function ft(t,{delay:e=0,duration:n=400,easing:o=gt}){const a=getComputedStyle(t),i=+a.opacity,r=parseFloat(a.height),l=parseFloat(a.paddingTop),c=parseFloat(a.paddingBottom),s=parseFloat(a.marginTop),u=parseFloat(a.marginBottom),d=parseFloat(a.borderTopWidth),p=parseFloat(a.borderBottomWidth);return{delay:e,duration:n,easing:o,css:t=>"overflow: hidden;"+`opacity: ${Math.min(20*t,1)*i};`+`height: ${t*r}px;`+`padding-top: ${t*l}px;`+`padding-bottom: ${t*c}px;`+`margin-top: ${t*s}px;`+`margin-bottom: ${t*u}px;`+`border-top-width: ${t*d}px;`+`border-bottom-width: ${t*p}px;`}}const ht=[];function vt(e,n=t){let o;const a=[];function i(t){if(l(e,t)&&(e=t,o)){const t=!ht.length;for(let t=0;t<a.length;t+=1){const n=a[t];n[1](),ht.push(n,e)}if(t){for(let t=0;t<ht.length;t+=2)ht[t][0](ht[t+1]);ht.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(r,l=t){const c=[r,l];return a.push(c),1===a.length&&(o=n(i)||t),r(e),()=>{const t=a.indexOf(c);-1!==t&&a.splice(t,1),0===a.length&&(o(),o=null)}}}}const $t=vt([]);function wt(t){$t.update(e=>[...e,t])}function yt(t){$t.update(e=>(e[e.length-1]=t,e))}const bt=vt({title:document.title,url:window.location.href});function xt(t){bt.set(t)}function Tt(t){bt.update(e=>{for(var n in t)e[n]=t[n];return e})}function Et(t){return{url:t.url,title:t.title||t.url.split("/").pop(),template:t.template||!1,worlditem:t.worlditem||!1}}function Rt(t){return""!==t&&"/"!==t&&(t.match(/^\/?archive\/.+\/.+/)?"entity":!!t.match(/^\/?archive.*/)&&"archive")}function _t(t){let e=t.search.match(/research=([^&]*)/);if(e)return e[0].replace("research=","");if(t.pathname){return t.pathname.split("/").pop()}return""}async function kt(t){t=t.replace(".json","");const e=new URL(t);t=e.origin+"/get"+e.pathname+e.search,console.log("loadData( "+t+" )");const n=await fetch(t);if(!n.ok)return console.error("HTTP-Error: "+n.status),!1;let o={};return"json"===(n.headers.get("content-type").includes("json")?"json":"html")?o=await n.json():(o.data={},o.data.html=await n.text()),o.data}let Lt=!1;async function Ct(t,e={},n=!1){if(!0===Lt)return console.log("navigateTo() already loading"),!1;if(t===window.location.href)return!1;const o=new URL(t);if(o.host!==window.location.host)return void window.open(o,"_blank");Lt=!0,e.url=t,e.template=e.template||Rt(o.pathname),e.title=e.title||_t(o);let a=Et(e);xt({...e,loading:!0}),!1===n?history.pushState(a,a.title,a.url):history.replaceState(a,a.title,a.url),wt(a);let i=await kt(t),r=["dynamic"];i.html?(i.url=a.url,i.title=a.title,i.template="html",r=[...r,"reqular","black"]):(a=Et(i),r=[...r,i.theme,i.layout,i.template,i.entity]),xt({...i,loading:!1}),history.replaceState(a,i.title,i.url),yt(a),document.body.className=r.join(" "),Lt=!1}let Ht=!1;async function Wt(t,e={},n=!1){if(!0===Ht)return console.log("replaceContent() already loading"),!1;if(t===window.location.href)return!1;console.log("REPLAAAACE");const o=new URL(t);Ht=!0;let a=history.state;a.url=t,a.title=e.title||_t(o),a.worlditem=e.worlditem||!1,Tt({...e,loading:!0}),!1===n?(wt(a),history.pushState(a,a.title,a.url)):(yt(a),history.replaceState(a,a.title,t));let i=await kt(t);a.title=i.title,a.worlditem=i.worlditem,window.goToItem(i.worlditem),Tt({...a,id:i.id,category:i.category,keywords:i.keywords,description:i.description,content:i.content,pagination:i.pagination||!1,loading:!1}),yt(a),history.replaceState(a,a.title,a.url),Ht=!1}function Mt(t){var e,n,o,a,i,r,l=t.target.title+"";const d=t.$$slots.default,p=c(d,t,null);return{c(){var i;e=x("a"),p||(n=T(l)),p&&p.c(),k(e,"href",o=t.target.url),k(e,"title",a=t.target.title),k(e,"class",t.classList),W(e,"current",t.target.url===window.location.href),r=_(e,"click",(i=t.onClick,function(t){return t.preventDefault(),i.call(this,t)}))},l(t){p&&p.l(a_nodes)},m(t,o){w(t,e,o),p?p.m(e,null):$(e,n),i=!0},p(t,r){p||i&&!t.target||l===(l=r.target.title+"")||L(n,l),p&&p.p&&t.$$scope&&p.p(u(d,r,t,null),s(d,r,null)),i&&!t.target||o===(o=r.target.url)||k(e,"href",o),i&&!t.target||a===(a=r.target.title)||k(e,"title",a),i&&!t.classList||k(e,"class",r.classList),(t.classList||t.target)&&W(e,"current",r.target.url===window.location.href)},i(t){i||(it(p,t),i=!0)},o(t){rt(p,t),i=!1},d(t){t&&y(e),p&&p.d(t),r()}}}function St(t,e,n){const o=D();let{target:a={},url:i=!1,title:r=!1,template:l=!1}=e;n("target",a.url=i||a.url,a),n("target",a.title=r||a.title,a),n("target",a.template=l||a.template,a);let{replace:c=!1,class:s=""}=e;let{$$slots:u={},$$scope:d}=e;return t.$set=(t=>{"target"in t&&n("target",a=t.target),"url"in t&&n("url",i=t.url),"title"in t&&n("title",r=t.title),"template"in t&&n("template",l=t.template),"replace"in t&&n("replace",c=t.replace),"class"in t&&n("classList",s=t.class),"$$scope"in t&&n("$$scope",d=t.$$scope)}),{target:a,url:i,title:r,template:l,replace:c,classList:s,onClick:function(t){a.worlditem&&document.body.classList.contains("liebling-house")?Wt(a.url,a,c):Ct(a.url,a,c),o("click",t)},$$slots:u,$$scope:d}}class jt extends mt{constructor(t){super(),pt(this,t,St,Mt,l,["target","url","title","template","replace","class"])}}function zt(t,e,n){const o=Object.create(t);return o.item=e[n],o}function It(t){var e,n,o,a,i=new jt({props:{target:t.item}});return{c(){e=x("li"),i.$$.fragment.c(),n=E(),k(e,"class",o=t.item.double?"double":"")},m(t,o){w(t,e,o),st(i,e,null),$(e,n),a=!0},p(t,n){var r={};t.list&&(r.target=n.item),i.$set(r),a&&!t.list||o===(o=n.item.double?"double":"")||k(e,"class",o)},i(t){a||(it(i.$$.fragment,t),a=!0)},o(t){rt(i.$$.fragment,t),a=!1},d(t){t&&y(e),ut(i)}}}function Pt(t){var e,n,o,a,i,r,l,c,s;let u=t.list,d=[];for(let e=0;e<u.length;e+=1)d[e]=It(zt(t,u,e));const p=t=>rt(d[t],1,1,()=>{d[t]=null});return{c(){e=x("nav"),(n=x("h3")).innerHTML=`<a href="${window.location.origin}" title="Start">Start</a>`,o=E(),a=x("ol"),i=x("div");for(let t=0;t<d.length;t+=1)d[t].c();K(()=>t.div_resize_handler.call(i)),K(()=>t.ol_resize_handler.call(a)),k(a,"class",c=t.innerWidth>t.outerWidth?"alignright":""),k(e,"class","bar history horizontal white")},m(c,u){w(c,e,u),$(e,n),$(e,o),$(e,a),$(a,i);for(let t=0;t<d.length;t+=1)d[t].m(i,null);r=H(i,t.div_resize_handler.bind(i)),l=H(a,t.ol_resize_handler.bind(a)),s=!0},p(t,e){if(t.list){let n;for(u=e.list,n=0;n<u.length;n+=1){const o=zt(e,u,n);d[n]?(d[n].p(t,o),it(d[n],1)):(d[n]=It(o),d[n].c(),it(d[n],1),d[n].m(i,null))}for(ot(),n=u.length;n<d.length;n+=1)p(n);at()}s&&!t.innerWidth&&!t.outerWidth||c===(c=e.innerWidth>e.outerWidth?"alignright":"")||k(a,"class",c)},i(t){if(!s){for(let t=0;t<u.length;t+=1)it(d[t]);s=!0}},o(t){d=d.filter(Boolean);for(let t=0;t<d.length;t+=1)rt(d[t]);s=!1},d(t){t&&y(e),b(d,t),r.cancel(),l.cancel()}}}function qt(t,e,n){let o;const a=$t.subscribe(t=>{t.length>50&&t.splice(1,1);let e=[];for(let n=t.length-1;n>=0;n--)e.includes(t[n].url)?t[n].double=!0:(t[n].double=!1,e.push(t[n].url));n("list",o=t)});let i,r;return F(()=>{a()}),{list:o,outerWidth:i,innerWidth:r,div_resize_handler:function(){r=this.offsetWidth,n("innerWidth",r)},ol_resize_handler:function(){i=this.offsetWidth,n("outerWidth",i)}}}class At extends mt{constructor(t){super(),pt(this,t,qt,Pt,l,[])}}function Bt(t,e,n){const o=Object.create(t);return o.keyword=e[n],o}function Ot(t){var e,n;let o=t.page.keywords,a=[];for(let e=0;e<o.length;e+=1)a[e]=Ft(Bt(t,o,e));const i=t=>rt(a[t],1,1,()=>{a[t]=null});return{c(){e=x("div");for(let t=0;t<a.length;t+=1)a[t].c();k(e,"class","right keywords")},m(t,o){w(t,e,o);for(let t=0;t<a.length;t+=1)a[t].m(e,null);n=!0},p(t,n){if(t.url||t.page){let r;for(o=n.page.keywords,r=0;r<o.length;r+=1){const i=Bt(n,o,r);a[r]?(a[r].p(t,i),it(a[r],1)):(a[r]=Ft(i),a[r].c(),it(a[r],1),a[r].m(e,null))}for(ot(),r=o.length;r<a.length;r+=1)i(r);at()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)it(a[t]);n=!0}},o(t){a=a.filter(Boolean);for(let t=0;t<a.length;t+=1)rt(a[t]);n=!1},d(t){t&&y(e),b(a,t)}}}function Ft(t){var e,n=new jt({props:{url:t.url+"?research="+t.keyword,template:"archive",title:t.keyword}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.page&&(o.url=e.url+"?research="+e.keyword),t.page&&(o.title=e.keyword),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function Dt(t){var e,n,o,a,i=new jt({props:{url:t.url,title:"Archive",template:"archive"}}),r=t.page.keywords&&Ot(t);return{c(){e=x("nav"),n=x("div"),i.$$.fragment.c(),o=E(),r&&r.c(),k(n,"class","left"),k(e,"class","bar archive horizontal")},m(t,l){w(t,e,l),$(e,n),st(i,n,null),$(e,o),r&&r.m(e,null),a=!0},p(t,n){n.page.keywords?r?(r.p(t,n),it(r,1)):((r=Ot(n)).c(),it(r,1),r.m(e,null)):r&&(ot(),rt(r,1,1,()=>{r=null}),at())},i(t){a||(it(i.$$.fragment,t),it(r),a=!0)},o(t){rt(i.$$.fragment,t),rt(r),a=!1},d(t){t&&y(e),ut(i),r&&r.d()}}}function Nt(t,e,n){let o=location.origin+"/archive",{page:a}=e;return t.$set=(t=>{"page"in t&&n("page",a=t.page)}),{url:o,page:a}}class Gt extends mt{constructor(t){super(),pt(this,t,Nt,Dt,l,["page"])}}function Vt(t){var e,n=t.item.thumbnail+"";return{c(){e=new S(n,null)},m(t,n){e.m(t,n)},p(t,o){t.item&&n!==(n=o.item.thumbnail+"")&&e.p(n)},d(t){t&&e.d()}}}function Ut(t){var e;return{c(){e=x("h5")},m(n,o){w(n,e,o),e.innerHTML=t.info},p(t,n){t.info&&(e.innerHTML=n.info)},d(t){t&&y(e)}}}function Jt(t){var e,n,o,a,i,r,l,c,s=t.item.count||"",u=t.item.title+"",d=t.item.thumbnail&&Vt(t),p=t.info&&Ut(t);return{c(){e=x("figure"),d&&d.c(),n=E(),o=x("div"),a=x("span"),i=T(s),r=E(),l=x("h4"),c=E(),p&&p.c(),k(a,"class","count"),k(o,"class","title")},m(t,s){w(t,e,s),d&&d.m(e,null),w(t,n,s),w(t,o,s),$(o,a),$(a,i),$(o,r),$(o,l),l.innerHTML=u,$(o,c),p&&p.m(o,null)},p(t,n){n.item.thumbnail?d?d.p(t,n):((d=Vt(n)).c(),d.m(e,null)):d&&(d.d(1),d=null),t.item&&s!==(s=n.item.count||"")&&L(i,s),t.item&&u!==(u=n.item.title+"")&&(l.innerHTML=u),n.info?p?p.p(t,n):((p=Ut(n)).c(),p.m(o,null)):p&&(p.d(1),p=null)},d(t){t&&y(e),d&&d.d(),t&&(y(n),y(o)),p&&p.d()}}}function Xt(t){var e,n,o,a=new jt({props:{target:t.item,$$slots:{default:[Jt]},$$scope:{ctx:t}}});return{c(){e=x("li"),a.$$.fragment.c(),k(e,"class",n="card "+t.classname+" "+t.item.classlist+" "+(t.width?"col-"+t.width:"")+" "+(t.item.thumbnail?"":"no-thumb"))},m(t,n){w(t,e,n),st(a,e,null),o=!0},p(t,i){var r={};t.item&&(r.target=i.item),(t.$$scope||t.info||t.item)&&(r.$$scope={changed:t,ctx:i}),a.$set(r),(!o||t.classname||t.item||t.width)&&n!==(n="card "+i.classname+" "+i.item.classlist+" "+(i.width?"col-"+i.width:"")+" "+(i.item.thumbnail?"":"no-thumb"))&&k(e,"class",n)},i(t){o||(it(a.$$.fragment,t),o=!0)},o(t){rt(a.$$.fragment,t),o=!1},d(t){t&&y(e),ut(a)}}}function Zt(t,e,n){let{item:o,width:a=!1,info:i=!1,classname:r=""}=e;return t.$set=(t=>{"item"in t&&n("item",o=t.item),"width"in t&&n("width",a=t.width),"info"in t&&n("info",i=t.info),"classname"in t&&n("classname",r=t.classname)}),{item:o,width:a,info:i,classname:r}}class Kt extends mt{constructor(t){super(),pt(this,t,Zt,Xt,l,["item","width","info","classname"])}}function Yt(t,e,n){const o=Object.create(t);return o.item=e[n],o}function Qt(t){var e,n=new Kt({props:{item:t.item,width:t.columnWidth}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.list&&(o.item=e.item),t.columnWidth&&(o.width=e.columnWidth),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function te(t){var e,n;let o=t.list,a=[];for(let e=0;e<o.length;e+=1)a[e]=Qt(Yt(t,o,e));const i=t=>rt(a[t],1,1,()=>{a[t]=null});return{c(){e=x("ul");for(let t=0;t<a.length;t+=1)a[t].c();k(e,"class","cards grid")},m(t,o){w(t,e,o);for(let t=0;t<a.length;t+=1)a[t].m(e,null);n=!0},p(t,n){if(t.list||t.columnWidth){let r;for(o=n.list,r=0;r<o.length;r+=1){const i=Yt(n,o,r);a[r]?(a[r].p(t,i),it(a[r],1)):(a[r]=Qt(i),a[r].c(),it(a[r],1),a[r].m(e,null))}for(ot(),r=o.length;r<a.length;r+=1)i(r);at()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)it(a[t]);n=!0}},o(t){a=a.filter(Boolean);for(let t=0;t<a.length;t+=1)rt(a[t]);n=!1},d(t){t&&y(e),b(a,t)}}}function ee(t,e,n){let{list:o,columns:a=2}=e,i=12/a;return O(()=>{n("columnWidth",i=12/a),o.length<4&&2==a&&n("columnWidth",i=12)}),t.$set=(t=>{"list"in t&&n("list",o=t.list),"columns"in t&&n("columns",a=t.columns)}),{list:o,columns:a,columnWidth:i}}class ne extends mt{constructor(t){super(),pt(this,t,ee,te,l,["list","columns"])}}function oe(t,e,n){const o=Object.create(t);return o.item=e[n],o}function ae(t){var e,n=new Kt({props:{item:t.item}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.list&&(o.item=e.item),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function ie(t){var e,n;let o=t.list,a=[];for(let e=0;e<o.length;e+=1)a[e]=ae(oe(t,o,e));const i=t=>rt(a[t],1,1,()=>{a[t]=null});return{c(){e=x("ul");for(let t=0;t<a.length;t+=1)a[t].c();k(e,"class","list")},m(t,o){w(t,e,o);for(let t=0;t<a.length;t+=1)a[t].m(e,null);n=!0},p(t,n){if(t.list){let r;for(o=n.list,r=0;r<o.length;r+=1){const i=oe(n,o,r);a[r]?(a[r].p(t,i),it(a[r],1)):(a[r]=ae(i),a[r].c(),it(a[r],1),a[r].m(e,null))}for(ot(),r=o.length;r<a.length;r+=1)i(r);at()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)it(a[t]);n=!0}},o(t){a=a.filter(Boolean);for(let t=0;t<a.length;t+=1)rt(a[t]);n=!1},d(t){t&&y(e),b(a,t)}}}function re(t,e,n){let{list:o,category:a=!1}=e;return t.$set=(t=>{"list"in t&&n("list",o=t.list),"category"in t&&n("category",a=t.category)}),{list:o,category:a}}class le extends mt{constructor(t){super(),pt(this,t,re,ie,l,["list","category"])}}function ce(t){var e,n,o,a,i=t.transcript.en+"";return{c(){e=x("div"),(n=x("h4")).textContent="EN",o=E(),a=new S(i,null),k(e,"class","en col-sm-"+t.columnWidth())},m(t,i){w(t,e,i),$(e,n),$(e,o),a.m(e)},p(t,e){t.transcript&&i!==(i=e.transcript.en+"")&&a.p(i)},d(t){t&&y(e)}}}function se(t){var e,n,o,a,i=t.transcript.de+"";return{c(){e=x("div"),(n=x("h4")).textContent="DE",o=E(),a=new S(i,null),k(e,"class","de col-sm-"+t.columnWidth())},m(t,i){w(t,e,i),$(e,n),$(e,o),a.m(e)},p(t,e){t.transcript&&i!==(i=e.transcript.de+"")&&a.p(i)},d(t){t&&y(e)}}}function ue(e){var n,o,a=e.transcript.en&&ce(e),i=e.transcript.de&&se(e);return{c(){n=x("div"),a&&a.c(),o=E(),i&&i.c(),k(n,"class","transcript grid")},m(t,e){w(t,n,e),a&&a.m(n,null),$(n,o),i&&i.m(n,null)},p(t,e){e.transcript.en?a?a.p(t,e):((a=ce(e)).c(),a.m(n,o)):a&&(a.d(1),a=null),e.transcript.de?i?i.p(t,e):((i=se(e)).c(),i.m(n,null)):i&&(i.d(1),i=null)},i:t,o:t,d(t){t&&y(n),a&&a.d(),i&&i.d()}}}function de(t,e,n){let{transcript:o}=e;return console.log(o),t.$set=(t=>{"transcript"in t&&n("transcript",o=t.transcript)}),{transcript:o,columnWidth:function(){return o.en&&o.de?6:12}}}class pe extends mt{constructor(t){super(),pt(this,t,de,ue,l,["transcript"])}}function me(t,e,n){const o=Object.create(t);return o.source=e[n],o}function ge(t){var e,n,o,a,i,r,l=!0===t.render&&fe(t),c=t.transcript&&$e(t);return{c(){e=x("section"),n=x("div"),l&&l.c(),o=E(),c&&c.c(),k(n,"class","section--content"),K(()=>t.section_resize_handler.call(e)),k(e,"class",i=t.classname+" "+t.view.type+" "+(t.transcript?"":"center"))},m(i,s){w(i,e,s),$(e,n),l&&l.m(n,null),$(e,o),c&&c.m(e,null),a=H(e,t.section_resize_handler.bind(e)),r=!0},p(t,o){!0===o.render?l?l.p(t,o):((l=fe(o)).c(),l.m(n,null)):l&&(l.d(1),l=null),o.transcript?c?(c.p(t,o),it(c,1)):((c=$e(o)).c(),it(c,1),c.m(e,null)):c&&(ot(),rt(c,1,1,()=>{c=null}),at()),(!r||t.classname||t.view||t.transcript)&&i!==(i=o.classname+" "+o.view.type+" "+(o.transcript?"":"center"))&&k(e,"class",i)},i(t){r||(it(c),r=!0)},o(t){rt(c),r=!1},d(t){t&&y(e),l&&l.d(),c&&c.d(),a.cancel()}}}function fe(t){var e,n,o;let a=t.view.content.srcset,i=[];for(let e=0;e<a.length;e+=1)i[e]=ve(me(t,a,e));return{c(){e=x("video");for(let t=0;t<i.length;t+=1)i[t].c();k(e,"width","100%"),k(e,"height","auto"),e.controls=!0,k(e,"preload","metadata"),k(e,"poster",n=t.view.content.poster),o=_(e,"contextmenu",ye)},m(n,o){w(n,e,o);for(let t=0;t<i.length;t+=1)i[t].m(e,null);t.video_binding(e)},p(t,o){if(t.videoWidth||t.view){let n;for(a=o.view.content.srcset,n=0;n<a.length;n+=1){const r=me(o,a,n);i[n]?i[n].p(t,r):(i[n]=ve(r),i[n].c(),i[n].m(e,null))}for(;n<i.length;n+=1)i[n].d(1);i.length=a.length}t.view&&n!==(n=o.view.content.poster)&&k(e,"poster",n)},d(n){n&&y(e),b(i,n),t.video_binding(null),o()}}}function he(t){var e,n,o,a;return{c(){k(e=x("source"),"type",n=t.source.mime),k(e,"media",o=t.source.media),k(e,"src",a=t.source.url)},m(t,n){w(t,e,n)},p(t,i){t.view&&n!==(n=i.source.mime)&&k(e,"type",n),t.view&&o!==(o=i.source.media)&&k(e,"media",o),t.view&&a!==(a=i.source.url)&&k(e,"src",a)},d(t){t&&y(e)}}}function ve(t){var e,n=t.videoWidth<t.source.width&&he(t);return{c(){n&&n.c(),e=R()},m(t,o){n&&n.m(t,o),w(t,e,o)},p(t,o){o.videoWidth<o.source.width?n?n.p(t,o):((n=he(o)).c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&y(e)}}}function $e(t){var e,n=new pe({props:{transcript:t.transcript}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.transcript&&(o.transcript=e.transcript),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function we(t){var e,n,o=t.view.content.srcset.length>0&&ge(t);return{c(){o&&o.c(),e=R()},m(t,a){o&&o.m(t,a),w(t,e,a),n=!0},p(t,n){n.view.content.srcset.length>0?o?(o.p(t,n),it(o,1)):((o=ge(n)).c(),it(o,1),o.m(e.parentNode,e)):o&&(ot(),rt(o,1,1,()=>{o=null}),at())},i(t){n||(it(o),n=!0)},o(t){rt(o),n=!1},d(t){o&&o.d(t),t&&y(e)}}}function ye(t){return t.preventDefault(),!1}function be(t,e,n){let o,{view:a}=e,{transcript:i=!1,classname:r="preview"}=e,l=0,c=!0;return t.$set=(t=>{"view"in t&&n("view",a=t.view),"transcript"in t&&n("transcript",i=t.transcript),"classname"in t&&n("classname",r=t.classname)}),t.$$.update=((t={view:1})=>{t.view&&(a.content.srcset[0].url,n("render",c=!1),setTimeout(()=>n("render",c=!0),0))}),{view:a,transcript:i,classname:r,mediaElement:o,videoWidth:l,render:c,video_binding:function(t){G[t?"unshift":"push"](()=>{n("mediaElement",o=t)})},section_resize_handler:function(){l=this.offsetWidth,n("videoWidth",l)}}}class xe extends mt{constructor(t){super(),pt(this,t,be,we,l,["view","transcript","classname"])}}function Te(t){var e,n=new pe({props:{transcript:t.transcript}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.transcript&&(o.transcript=e.transcript),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function Ee(t){var e,n,o,a,i,r,l,c=t.transcript&&Te(t);return{c(){e=x("section"),n=x("div"),o=x("audio"),i=E(),c&&c.c(),k(o,"width","100%"),k(o,"height","auto"),o.controls=!0,k(o,"preload","meta"),k(o,"src",a=t.view.content.url),k(o,"class","svelte-lzdsfu"),k(n,"class","section--content svelte-lzdsfu"),k(e,"class",r=t.classname+" "+t.view.type+" "+(t.transcript?"":"center")+" svelte-lzdsfu")},m(a,r){w(a,e,r),$(e,n),$(n,o),t.audio_binding(o),$(e,i),c&&c.m(e,null),l=!0},p(t,n){l&&!t.view||a===(a=n.view.content.url)||k(o,"src",a),n.transcript?c?(c.p(t,n),it(c,1)):((c=Te(n)).c(),it(c,1),c.m(e,null)):c&&(ot(),rt(c,1,1,()=>{c=null}),at()),(!l||t.classname||t.view||t.transcript)&&r!==(r=n.classname+" "+n.view.type+" "+(n.transcript?"":"center")+" svelte-lzdsfu")&&k(e,"class",r)},i(t){l||(it(c),l=!0)},o(t){rt(c),l=!1},d(n){n&&y(e),t.audio_binding(null),c&&c.d()}}}function Re(t,e,n){let{view:o}=e,{transcript:a,classname:i="preview"}=e;O(()=>{!1!==r&&r.pause()});let r=!1;return t.$set=(t=>{"view"in t&&n("view",o=t.view),"transcript"in t&&n("transcript",a=t.transcript),"classname"in t&&n("classname",i=t.classname)}),{view:o,transcript:a,classname:i,mediaElement:r,audio_binding:function(t){G[t?"unshift":"push"](()=>{n("mediaElement",r=t)})}}}class _e extends mt{constructor(t){super(),pt(this,t,Re,Ee,l,["view","transcript","classname"])}}function ke(t,e,n){const o=Object.create(t);return o.item=e[n],o}function Le(t){var e,n=new Kt({props:{item:t.item,classname:"card-element",width:t.columnWidth}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.list&&(o.item=e.item),t.columnWidth&&(o.width=e.columnWidth),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function Ce(t){var e,n,o,a,i,r=t.views[t.item.view.type];function l(t){return{props:{view:t.item.view}}}if(r)var c=new r(l(t));var s=new jt({props:{target:t.item,$$slots:{default:[We]},$$scope:{ctx:t}}});return{c(){e=x("li"),c&&c.$$.fragment.c(),n=E(),s.$$.fragment.c(),o=E(),k(e,"class",a="card preview "+t.item.classlist+" "+(t.columnWidth?"col-"+t.columnWidth:""))},m(t,a){w(t,e,a),c&&st(c,e,null),$(e,n),st(s,e,null),$(e,o),i=!0},p(t,o){var u={};if(t.list&&(u.view=o.item.view),r!==(r=o.views[o.item.view.type])){if(c){ot();const t=c;rt(t.$$.fragment,1,0,()=>{ut(t,1)}),at()}r?((c=new r(l(o))).$$.fragment.c(),it(c.$$.fragment,1),st(c,e,n)):c=null}else r&&c.$set(u);var d={};t.list&&(d.target=o.item),(t.$$scope||t.list)&&(d.$$scope={changed:t,ctx:o}),s.$set(d),i&&!t.list&&!t.columnWidth||a===(a="card preview "+o.item.classlist+" "+(o.columnWidth?"col-"+o.columnWidth:""))||k(e,"class",a)},i(t){i||(c&&it(c.$$.fragment,t),it(s.$$.fragment,t),i=!0)},o(t){c&&rt(c.$$.fragment,t),rt(s.$$.fragment,t),i=!1},d(t){t&&y(e),c&&ut(c),ut(s)}}}function He(t){var e,n=new Kt({props:{item:t.item,classname:"list-element",width:t.columnWidth}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.list&&(o.item=e.item),t.columnWidth&&(o.width=e.columnWidth),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function We(t){var e,n,o,a,i,r=t.item.count||"",l=t.item.title+"";return{c(){e=x("div"),n=x("span"),o=T(r),a=E(),i=x("h4"),k(n,"class","count"),k(e,"class","title")},m(t,r){w(t,e,r),$(e,n),$(n,o),$(e,a),$(e,i),i.innerHTML=l},p(t,e){t.list&&r!==(r=e.item.count||"")&&L(o,r),t.list&&l!==(l=e.item.title+"")&&(i.innerHTML=l)},d(t){t&&y(e)}}}function Me(t){var e,n,o,a,i=[He,Ce,Le],r=[];function l(t,e){return"tourstop"==e.category&&null!==e.item.worlditem?0:!e.item.view||"audio"!=e.item.view.type&&"video"!=e.item.view.type?2:1}return e=l(0,t),n=r[e]=i[e](t),{c(){n.c(),o=R()},m(t,n){r[e].m(t,n),w(t,o,n),a=!0},p(t,a){var c=e;(e=l(0,a))===c?r[e].p(t,a):(ot(),rt(r[c],1,1,()=>{r[c]=null}),at(),(n=r[e])||(n=r[e]=i[e](a)).c(),it(n,1),n.m(o.parentNode,o))},i(t){a||(it(n),a=!0)},o(t){rt(n),a=!1},d(t){r[e].d(t),t&&y(o)}}}function Se(t){var e,n,o;let a=t.list,i=[];for(let e=0;e<a.length;e+=1)i[e]=Me(ke(t,a,e));const r=t=>rt(i[t],1,1,()=>{i[t]=null});return{c(){e=x("ul");for(let t=0;t<i.length;t+=1)i[t].c();k(e,"class",n="gallery "+(1!==t.columns?"grid":""))},m(t,n){w(t,e,n);for(let t=0;t<i.length;t+=1)i[t].m(e,null);o=!0},p(t,l){if(t.category||t.list||t.columnWidth||t.views){let n;for(a=l.list,n=0;n<a.length;n+=1){const o=ke(l,a,n);i[n]?(i[n].p(t,o),it(i[n],1)):(i[n]=Me(o),i[n].c(),it(i[n],1),i[n].m(e,null))}for(ot(),n=a.length;n<i.length;n+=1)r(n);at()}o&&!t.columns||n===(n="gallery "+(1!==l.columns?"grid":""))||k(e,"class",n)},i(t){if(!o){for(let t=0;t<a.length;t+=1)it(i[t]);o=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)rt(i[t]);o=!1},d(t){t&&y(e),b(i,t)}}}function je(t,e,n){let{list:o,category:a=""}=e,i={video:xe,audio:_e},{columns:r=1}=e,l=12/r;return O(()=>{n("columnWidth",l=12/r),o.length<4&&2==r&&n("columnWidth",l=12)}),t.$set=(t=>{"list"in t&&n("list",o=t.list),"category"in t&&n("category",a=t.category),"columns"in t&&n("columns",r=t.columns)}),{list:o,category:a,views:i,columns:r,columnWidth:l}}class ze extends mt{constructor(t){super(),pt(this,t,je,Se,l,["list","category","columns"])}}function Ie(t){var e;function n(t,e){return!0===e.loading?qe:Pe}var o=n(0,t),a=o(t);return{c(){e=x("div"),a.c(),k(e,"class","load-more")},m(t,n){w(t,e,n),a.m(e,null)},p(t,i){o!==(o=n(0,i))&&(a.d(1),(a=o(i))&&(a.c(),a.m(e,null)))},d(t){t&&y(e),a.d()}}}function Pe(t){var e,n;return{c(){(e=x("button")).textContent="Load more",k(e,"class","card"),n=_(e,"click",t.loadNext)},m(t,n){w(t,e,n)},d(t){t&&y(e),n()}}}function qe(t){var e;return{c(){k(e=x("div"),"class","is-loading")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function Ae(t){var e,n,o,a,r,l,c,s,u,d,p,m,g,f=t.view.total+"";return{c(){e=x("div"),n=x("div"),(o=x("span")).textContent="Display as:",a=E(),(r=x("button")).textContent="Cards",l=E(),(c=x("button")).textContent="List",s=E(),u=x("div"),d=x("span"),p=T(f),m=T(" Results"),k(n,"class","left display"),k(u,"class","right info"),k(e,"class","bar controls"),g=[_(r,"click",t.click_handler),_(c,"click",t.click_handler_1)]},m(t,i){w(t,e,i),$(e,n),$(n,o),$(n,a),$(n,r),$(n,l),$(n,c),$(e,s),$(e,u),$(u,d),$(d,p),$(d,m)},p(t,e){t.view&&f!==(f=e.view.total+"")&&L(p,f)},d(t){t&&y(e),i(g)}}}function Be(t){var e,n,o,a,i,r,l,c,s=t.layouts[t.layout];function u(t){return{props:{list:t.view.content,columns:t.columns}}}if(s)var d=new s(u(t));var p=(t.view.next||!0===t.loading)&&Ie(t),m=t.controls&&Ae(t);return{c(){e=x("section"),n=x("div"),d&&d.$$.fragment.c(),o=E(),p&&p.c(),i=E(),m&&m.c(),K(()=>t.div_resize_handler.call(n)),k(n,"class","section--content svelte-1mm2wm5"),k(e,"class",r=t.classname+" "+t.view.type+" svelte-1mm2wm5"),c=_(e,"scroll",t.scrollTrigger,{passive:!0})},m(r,c){w(r,e,c),$(e,n),d&&st(d,n,null),$(n,o),p&&p.m(n,null),a=H(n,t.div_resize_handler.bind(n)),$(e,i),m&&m.m(e,null),t.section_binding(e),l=!0},p(t,a){var i={};if(t.view&&(i.list=a.view.content),t.columns&&(i.columns=a.columns),s!==(s=a.layouts[a.layout])){if(d){ot();const t=d;rt(t.$$.fragment,1,0,()=>{ut(t,1)}),at()}s?((d=new s(u(a))).$$.fragment.c(),it(d.$$.fragment,1),st(d,n,o)):d=null}else s&&d.$set(i);a.view.next||!0===a.loading?p?p.p(t,a):((p=Ie(a)).c(),p.m(n,null)):p&&(p.d(1),p=null),a.controls?m?m.p(t,a):((m=Ae(a)).c(),m.m(e,null)):m&&(m.d(1),m=null),l&&!t.classname&&!t.view||r===(r=a.classname+" "+a.view.type+" svelte-1mm2wm5")||k(e,"class",r)},i(t){l||(d&&it(d.$$.fragment,t),l=!0)},o(t){d&&rt(d.$$.fragment,t),l=!1},d(n){n&&y(e),d&&ut(d),p&&p.d(),a.cancel(),m&&m.d(),t.section_binding(null),c()}}}let Oe=4e3;function Fe(t,e,n){let{transcript:o=!1,view:a,classname:i,controls:r=!1,columns:l=a.columns||2}=e,c={cards:ne,list:le,gallery:ze},{layout:s="cards"}=e;var u;u=(()=>{"layout"in a&&n("layout",s=a.layout)}),B().$$.after_update.push(u);let d=!1;async function p(){n("loading",d=!0);let t=await kt(a.next);t&&(n("loading",d=!1),n("view",a.next=t.next,a),n("view",a.content=a.content.concat(t.content),a))}let m=100,g=0,f=0;return t.$set=(t=>{"transcript"in t&&n("transcript",o=t.transcript),"view"in t&&n("view",a=t.view),"classname"in t&&n("classname",i=t.classname),"controls"in t&&n("controls",r=t.controls),"columns"in t&&n("columns",l=t.columns),"layout"in t&&n("layout",s=t.layout)}),{transcript:o,view:a,classname:i,controls:r,columns:l,layouts:c,layout:s,loading:d,loadNext:p,pageHeight:m,container:g,scrollTrigger:function(){!1!==a.next&&!0!==d&&(f=g.scrollTop)>m-Oe&&p()},div_resize_handler:function(){m=this.clientHeight,n("pageHeight",m)},click_handler:()=>n("layout",s="cards"),click_handler_1:()=>n("layout",s="list"),section_binding:function(t){G[t?"unshift":"push"](()=>{n("container",g=t)})}}}class De extends mt{constructor(t){super(),pt(this,t,Fe,Be,l,["transcript","view","classname","controls","columns","layout"])}}function Ne(t,e,n){const o=Object.create(t);return o.item=e[n],o}function Ge(t){var e,n,o,a;let i=t.page.archive.filters.content,r=[];for(let e=0;e<i.length;e+=1)r[e]=Ve(Ne(t,i,e));return{c(){e=x("section"),(n=x("h2")).textContent="Filter",o=E(),a=x("ul");for(let t=0;t<r.length;t+=1)r[t].c();k(a,"class","list"),k(e,"class","filters tab")},m(t,i){w(t,e,i),$(e,n),$(e,o),$(e,a);for(let t=0;t<r.length;t+=1)r[t].m(a,null)},p(t,e){if(t.page||t.archive){let n;for(i=e.page.archive.filters.content,n=0;n<i.length;n+=1){const o=Ne(e,i,n);r[n]?r[n].p(t,o):(r[n]=Ve(o),r[n].c(),r[n].m(a,null))}for(;n<r.length;n+=1)r[n].d(1);r.length=i.length}},d(t){t&&y(e),b(r,t)}}}function Ve(t){var e,n,o,a,i,r,l,c=t.item.title+"";function s(){return t.click_handler_1(t)}return{c(){e=x("li"),n=x("button"),o=x("div"),a=x("h4"),i=E(),k(o,"class","title"),k(e,"class",r="card "+(t.item.filter===t.archive.filter?"active":"")),l=_(n,"click",s)},m(t,r){w(t,e,r),$(e,n),$(n,o),$(o,a),a.innerHTML=c,$(e,i)},p(n,o){t=o,n.page&&c!==(c=t.item.title+"")&&(a.innerHTML=c),(n.page||n.archive)&&r!==(r="card "+(t.item.filter===t.archive.filter?"active":""))&&k(e,"class",r)},d(t){t&&y(e),l()}}}function Ue(t){var e;return{c(){k(e=x("div"),"class","is-loading")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function Je(t){var e,n,o,a,i=[Ze,Xe],r=[];function l(t,e){return 0===e.page.results.total&&""!==e.archive.query?0:1}return e=l(0,t),n=r[e]=i[e](t),{c(){n.c(),o=R()},m(t,n){r[e].m(t,n),w(t,o,n),a=!0},p(t,a){var c=e;(e=l(0,a))===c?r[e].p(t,a):(ot(),rt(r[c],1,1,()=>{r[c]=null}),at(),(n=r[e])||(n=r[e]=i[e](a)).c(),it(n,1),n.m(o.parentNode,o))},i(t){a||(it(n),a=!0)},o(t){rt(n),a=!1},d(t){r[e].d(t),t&&y(o)}}}function Xe(t){var e,n=new De({props:{view:t.page.results,classname:"presentation panel col-sm-9",controls:!0,columns:"3"}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.page&&(o.view=e.page.results),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function Ze(e){var n,o,a,i,r=e.archive.query+"",l=e.archive.filter&&Ke(e);return{c(){n=x("div"),o=T("No results for »"),a=T(r),i=T("«\n\t\t\t\t"),l&&l.c(),k(n,"class","panel col-sm-9 empty-results")},m(t,e){w(t,n,e),$(n,o),$(n,a),$(n,i),l&&l.m(n,null)},p(t,e){t.archive&&r!==(r=e.archive.query+"")&&L(a,r),e.archive.filter?l?l.p(t,e):((l=Ke(e)).c(),l.m(n,null)):l&&(l.d(1),l=null)},i:t,o:t,d(t){t&&y(n),l&&l.d()}}}function Ke(t){var e,n,o=t.archive.filter+"";return{c(){e=T("in "),n=T(o)},m(t,o){w(t,e,o),w(t,n,o)},p(t,e){t.archive&&o!==(o=e.archive.filter+"")&&L(n,o)},d(t){t&&(y(e),y(n))}}}function Ye(t){var e,n,o,a,r,l,c,s,u,d,p,m,g,f=t.page.archive&&t.page.archive.filters&&Ge(t),h=(!0===t.loading||t.page.loading)&&Ue(),v=t.page.results&&Je(t);return{c(){e=x("div"),n=x("main"),o=x("div"),a=x("header"),(r=x("h1")).textContent="Archive",l=E(),c=x("form"),s=x("input"),u=E(),f&&f.c(),d=E(),h&&h.c(),p=E(),v&&v.c(),k(s,"class","input"),k(s,"type","search"),k(s,"name","research"),k(s,"autocomplete","off"),k(s,"spellcheck","false"),k(s,"autocorrect","off"),k(s,"aria-label","Search the archive ..."),k(s,"placeholder","Search the archive ..."),k(c,"id","search"),k(c,"autocomplete","off"),k(a,"id","top"),k(a,"class","tab"),k(o,"class","content"),k(n,"class","panel col-sm-3"),k(e,"class","grid panels"),g=[_(s,"input",t.input_input_handler),_(s,"input",t.input_handler),_(c,"click",t.click_handler)]},m(i,g){w(i,e,g),$(e,n),$(n,o),$(o,a),$(a,r),$(a,l),$(a,c),$(c,s),C(s,t.archive.query),t.input_binding(s),$(o,u),f&&f.m(o,null),$(e,d),h&&h.m(e,null),$(e,p),v&&v.m(e,null),m=!0},p(t,n){t.archive&&C(s,n.archive.query),n.page.archive&&n.page.archive.filters?f?f.p(t,n):((f=Ge(n)).c(),f.m(o,null)):f&&(f.d(1),f=null),!0===n.loading||n.page.loading?h||((h=Ue()).c(),h.m(e,p)):h&&(h.d(1),h=null),n.page.results?v?(v.p(t,n),it(v,1)):((v=Je(n)).c(),it(v,1),v.m(e,null)):v&&(ot(),rt(v,1,1,()=>{v=null}),at())},i(t){m||(it(v),m=!0)},o(t){rt(v),m=!1},d(n){n&&y(e),t.input_binding(null),f&&f.d(),h&&h.d(),v&&v.d(),i(g)}}}function Qe(t,e,n){let o,{page:a}=e,i=!1,r={filter:!1,query:"",previous:{url:!1},url:window.location.origin+"/archive",wait:!1,input:function(){clearTimeout(this.wait),this.wait=setTimeout(()=>{this.search()},250)},search:async function(){n("loading",i=!0);let t=this.url;if(this.filter&&(t+="/"+encodeURIComponent(this.filter)),this.query&&(t+="?research="+encodeURIComponent(this.query)),t===this.previous.url)return!1;this.previous.url=t,console.log("search "+t);let e=history.state;e.url=t,history.replaceState(e,e.title,e.url),Tt({results:(await kt(t)).results}),n("loading",i=!1)}};const l=bt.subscribe(t=>{t.archive&&(t.archive.filter&&n("archive",r.filter=t.archive.filter,r),t.archive.query&&n("archive",r.query=t.archive.query,r)),!1===t.loading&&setTimeout(()=>{l()},5)});return t.$set=(t=>{"page"in t&&n("page",a=t.page)}),{page:a,field:o,loading:i,archive:r,input_input_handler:function(){r.query=this.value,n("archive",r)},input_binding:function(t){G[t?"unshift":"push"](()=>{n("field",o=t)})},input_handler:()=>r.input(),click_handler:()=>o.focus(),click_handler_1:({item:t})=>{n("archive",r.filter=t.filter,r),r.search()}}}class tn extends mt{constructor(t){super(),pt(this,t,Qe,Ye,l,["page"])}}function en(t){var e,n=t.tab.content.h2+"";return{c(){k(e=x("h2"),"class","subtitle")},m(t,o){w(t,e,o),e.innerHTML=n},p(t,o){t.tab&&n!==(n=o.tab.content.h2+"")&&(e.innerHTML=n)},d(t){t&&y(e)}}}function nn(t){var e,n=t.tab.content.p+"";return{c(){k(e=x("div"),"class","highlight")},m(t,o){w(t,e,o),e.innerHTML=n},p(t,o){t.tab&&n!==(n=o.tab.content.p+"")&&(e.innerHTML=n)},d(t){t&&y(e)}}}function on(e){var n,o,a,i,r=e.tab.content.h1+"",l=e.tab.content.h2&&en(e),c=e.tab.content.p&&nn(e);return{c(){n=x("header"),o=x("h1"),a=E(),l&&l.c(),i=E(),c&&c.c(),k(o,"class","title"),k(n,"id","top"),k(n,"class","tab")},m(t,e){w(t,n,e),$(n,o),o.innerHTML=r,$(n,a),l&&l.m(n,null),$(n,i),c&&c.m(n,null)},p(t,e){t.tab&&r!==(r=e.tab.content.h1+"")&&(o.innerHTML=r),e.tab.content.h2?l?l.p(t,e):((l=en(e)).c(),l.m(n,i)):l&&(l.d(1),l=null),e.tab.content.p?c?c.p(t,e):((c=nn(e)).c(),c.m(n,null)):c&&(c.d(1),c=null)},i:t,o:t,d(t){t&&y(n),l&&l.d(),c&&c.d()}}}function an(t,e,n){let{entity:o,tab:a,category:i}=e;return t.$set=(t=>{"entity"in t&&n("entity",o=t.entity),"tab"in t&&n("tab",a=t.tab),"category"in t&&n("category",i=t.category)}),{entity:o,tab:a,category:i}}class rn extends mt{constructor(t){super(),pt(this,t,an,on,l,["entity","tab","category"])}}function ln(t,e,n){const o=Object.create(t);return o.item=e[n],o}function cn(t){var e,n=new Kt({props:{item:t.item,info:t.item.info}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.list&&(o.item=e.item),t.list&&(o.info=e.item.info),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function sn(t){var e,n;let o=t.list,a=[];for(let e=0;e<o.length;e+=1)a[e]=cn(ln(t,o,e));const i=t=>rt(a[t],1,1,()=>{a[t]=null});return{c(){e=x("ul");for(let t=0;t<a.length;t+=1)a[t].c();k(e,"class","entityinfo")},m(t,o){w(t,e,o);for(let t=0;t<a.length;t+=1)a[t].m(e,null);n=!0},p(t,n){if(t.list){let r;for(o=n.list,r=0;r<o.length;r+=1){const i=ln(n,o,r);a[r]?(a[r].p(t,i),it(a[r],1)):(a[r]=cn(i),a[r].c(),it(a[r],1),a[r].m(e,null))}for(ot(),r=o.length;r<a.length;r+=1)i(r);at()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)it(a[t]);n=!0}},o(t){a=a.filter(Boolean);for(let t=0;t<a.length;t+=1)rt(a[t]);n=!1},d(t){t&&y(e),b(a,t)}}}function un(t,e,n){let{list:o}=e;return t.$set=(t=>{"list"in t&&n("list",o=t.list)}),{list:o}}class dn extends mt{constructor(t){super(),pt(this,t,un,sn,l,["list"])}}function pn(t){var e,n,o=t.tab.headline+"";return{c(){e=x("h3"),n=T(o),k(e,"class","section--header")},m(t,o){w(t,e,o),$(e,n)},p(t,e){t.tab&&o!==(o=e.tab.headline+"")&&L(n,o)},d(t){t&&y(e)}}}function mn(t){var e,n,o,a,i,r=t.tab.headline&&pn(t),l=t.layout[t.tab.layout];function c(t){return{props:{list:t.tab.content,category:t.category}}}if(l)var s=new l(c(t));return{c(){e=x("section"),r&&r.c(),n=E(),o=x("div"),s&&s.$$.fragment.c(),k(o,"class","section--content"),k(e,"class",a="tab collection "+t.tab.layout)},m(t,a){w(t,e,a),r&&r.m(e,null),$(e,n),$(e,o),s&&st(s,o,null),i=!0},p(t,u){u.tab.headline?r?r.p(t,u):((r=pn(u)).c(),r.m(e,n)):r&&(r.d(1),r=null);var d={};if(t.tab&&(d.list=u.tab.content),t.category&&(d.category=u.category),l!==(l=u.layout[u.tab.layout])){if(s){ot();const t=s;rt(t.$$.fragment,1,0,()=>{ut(t,1)}),at()}l?((s=new l(c(u))).$$.fragment.c(),it(s.$$.fragment,1),st(s,o,null)):s=null}else l&&s.$set(d);i&&!t.tab||a===(a="tab collection "+u.tab.layout)||k(e,"class",a)},i(t){i||(s&&it(s.$$.fragment,t),i=!0)},o(t){s&&rt(s.$$.fragment,t),i=!1},d(t){t&&y(e),r&&r.d(),s&&ut(s)}}}function gn(t,e,n){let{entity:o,tab:a,category:i}=e,r={cards:ne,list:le,entityinfo:dn,gallery:ze};return t.$set=(t=>{"entity"in t&&n("entity",o=t.entity),"tab"in t&&n("tab",a=t.tab),"category"in t&&n("category",i=t.category)}),{entity:o,tab:a,category:i,layout:r}}class fn extends mt{constructor(t){super(),pt(this,t,gn,mn,l,["entity","tab","category"])}}function hn(t,e,n){const o=Object.create(t);return o.bit=e[n],o}function vn(t,e,n){const o=Object.create(t);return o.line=e[n],o}function $n(t){var e,n,o;let a=t.tab.content,i=[];for(let e=0;e<a.length;e+=1)i[e]=Rn(vn(t,a,e));const r=t=>rt(i[t],1,1,()=>{i[t]=null});return{c(){e=x("dl");for(let t=0;t<i.length;t+=1)i[t].c();k(e,"class","section--content table")},m(t,n){w(t,e,n);for(let t=0;t<i.length;t+=1)i[t].m(e,null);o=!0},p(t,n){if(t.tab||t.cellSize){let o;for(a=n.tab.content,o=0;o<a.length;o+=1){const r=vn(n,a,o);i[o]?(i[o].p(t,r),it(i[o],1)):(i[o]=Rn(r),i[o].c(),it(i[o],1),i[o].m(e,null))}for(ot(),o=a.length;o<i.length;o+=1)r(o);at()}},i(t){if(!o){for(let t=0;t<a.length;t+=1)it(i[t]);K(()=>{n||(n=ct(e,ft,{duration:200},!0)),n.run(1)}),o=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)rt(i[t]);n||(n=ct(e,ft,{duration:200},!1)),n.run(0),o=!1},d(t){t&&y(e),b(i,t),t&&n&&n.end()}}}function wn(t){var e,n,o=t.line.key+"";return{c(){e=x("dt"),n=T(o)},m(t,o){w(t,e,o),$(e,n)},p(t,e){t.tab&&o!==(o=e.line.key+"")&&L(n,o)},d(t){t&&y(e)}}}function yn(e){var n;return{c(){(n=x("dt")).textContent="Description",k(n,"class","empty")},m(t,e){w(t,n,e)},p:t,d(t){t&&y(n)}}}function bn(e){var n,o,a=e.line.value+"";return{c(){k(n=x("dd"),"class",o=kn(e.line.key+e.line.value))},m(t,e){w(t,n,e),n.innerHTML=a},p(t,e){t.tab&&a!==(a=e.line.value+"")&&(n.innerHTML=a),t.tab&&o!==(o=kn(e.line.key+e.line.value))&&k(n,"class",o)},i:t,o:t,d(t){t&&y(n)}}}function xn(e){var n;let o=e.line.value,a=[];for(let t=0;t<o.length;t+=1)a[t]=En(hn(e,o,t));return{c(){n=x("div");for(let t=0;t<a.length;t+=1)a[t].c()},m(t,e){w(t,n,e);for(let t=0;t<a.length;t+=1)a[t].m(n,null)},p(t,e){if(t.cellSize||t.tab){let i;for(o=e.line.value,i=0;i<o.length;i+=1){const r=hn(e,o,i);a[i]?a[i].p(t,r):(a[i]=En(r),a[i].c(),a[i].m(n,null))}for(;i<a.length;i+=1)a[i].d(1);a.length=o.length}},i:t,o:t,d(t){t&&y(n),b(a,t)}}}function Tn(t){var e,n=new le({props:{list:t.line.value}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.tab&&(o.list=e.line.value),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function En(t){var e,n,o=t.bit+"";return{c(){k(e=x("dd"),"class",n=kn(t.line.key+t.line.value))},m(t,n){w(t,e,n),e.innerHTML=o},p(t,a){t.tab&&o!==(o=a.bit+"")&&(e.innerHTML=o),t.tab&&n!==(n=kn(a.line.key+a.line.value))&&k(e,"class",n)},d(t){t&&y(e)}}}function Rn(t){var e,n,o,a,i,r,l;function c(t,e){return""==e.line.key?yn:wn}var s=c(0,t),u=s(t),d=[Tn,xn,bn],p=[];function m(t,e){return e.line.type&&"collection"==e.line.type?0:((null==o||t.tab)&&(o=!!Array.isArray(e.line.value)),o?1:2)}return a=m(null,t),i=p[a]=d[a](t),{c(){e=x("div"),u.c(),n=E(),i.c(),r=E()},m(t,o){w(t,e,o),u.m(e,null),$(e,n),p[a].m(e,null),$(e,r),l=!0},p(t,o){s===(s=c(0,o))&&u?u.p(t,o):(u.d(1),(u=s(o))&&(u.c(),u.m(e,n)));var l=a;(a=m(t,o))===l?p[a].p(t,o):(ot(),rt(p[l],1,1,()=>{p[l]=null}),at(),(i=p[a])||(i=p[a]=d[a](o)).c(),it(i,1),i.m(e,r))},i(t){l||(it(i),l=!0)},o(t){rt(i),l=!1},d(t){t&&y(e),u.d(),p[a].d()}}}function _n(t){var e,n,o,a,i,r,l,c=t.tab.headline||"Info",s=t.open&&$n(t);return{c(){e=x("section"),n=x("h3"),o=T(c),a=E(),s&&s.c(),k(n,"class","section--header"),k(e,"class",i="tab accordion "+t.tabClass(t.tab.headline)),W(e,"open",t.open),l=_(n,"click",t.click_handler)},m(t,i){w(t,e,i),$(e,n),$(n,o),$(e,a),s&&s.m(e,null),r=!0},p(t,n){r&&!t.tab||c===(c=n.tab.headline||"Info")||L(o,c),n.open?s?(s.p(t,n),it(s,1)):((s=$n(n)).c(),it(s,1),s.m(e,null)):s&&(ot(),rt(s,1,1,()=>{s=null}),at()),r&&!t.tab||i===(i="tab accordion "+n.tabClass(n.tab.headline))||k(e,"class",i),(t.tab||t.open)&&W(e,"open",n.open)},i(t){r||(it(s),r=!0)},o(t){rt(s),r=!1},d(t){t&&y(e),s&&s.d(),l()}}}function kn(t){return(t=t.replace(/<[^>]+>/g,"")).length>160?"long":""}function Ln(t,e,n){let{tab:o,category:a,entity:i}=e,r=!1;return t.$set=(t=>{"tab"in t&&n("tab",o=t.tab),"category"in t&&n("category",a=t.category),"entity"in t&&n("entity",i=t.entity)}),{tab:o,category:a,entity:i,open:r,tabClass:function(t=""){return"meta"==(t=t.toLowerCase())&&"file"!=i||n("open",r=!0),t},click_handler:()=>n("open",r=!r)}}class Cn extends mt{constructor(t){super(),pt(this,t,Ln,_n,l,["tab","category","entity"])}}function Hn(e){var n,o,a,i,r,l=e.tab.headline+"",c=e.tab.content.html||"";return{c(){n=x("section"),o=x("h3"),a=T(l),i=E(),r=x("div"),k(o,"class","section--header"),k(r,"class","bodytext"),k(n,"class","tab text")},m(t,e){w(t,n,e),$(n,o),$(o,a),$(n,i),$(n,r),r.innerHTML=c},p(t,e){t.tab&&l!==(l=e.tab.headline+"")&&L(a,l),t.tab&&c!==(c=e.tab.content.html||"")&&(r.innerHTML=c)},i:t,o:t,d(t){t&&y(n)}}}function Wn(t,e,n){let{tab:o,category:a}=e;return t.$set=(t=>{"tab"in t&&n("tab",o=t.tab),"category"in t&&n("category",a=t.category)}),{tab:o,category:a}}class Mn extends mt{constructor(t){super(),pt(this,t,Wn,Hn,l,["tab","category"])}}function Sn(e){var n,o,a,i,r=e.view.content.html+"";return{c(){n=x("section"),o=x("div"),a=x("figure"),k(o,"class","section--content"),k(n,"class",i=e.classname+" "+e.view.type)},m(t,e){w(t,n,e),$(n,o),$(o,a),a.innerHTML=r},p(t,e){t.view&&r!==(r=e.view.content.html+"")&&(a.innerHTML=r),(t.classname||t.view)&&i!==(i=e.classname+" "+e.view.type)&&k(n,"class",i)},i:t,o:t,d(t){t&&y(n)}}}function jn(t,e,n){let{view:o,classname:a,transcript:i}=e;return t.$set=(t=>{"view"in t&&n("view",o=t.view),"classname"in t&&n("classname",a=t.classname),"transcript"in t&&n("transcript",i=t.transcript)}),{view:o,classname:a,transcript:i}}class zn extends mt{constructor(t){super(),pt(this,t,jn,Sn,l,["view","classname","transcript"])}}function In(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Pn(t,e,n){const o=D();let{dependencies:a}=e,i=0,r=[];for(const t of a){let e=document.createElement("script");e.type="text/javascript",e.src=t,e.async=!1,e.onload=function(){i++,console.log("Load "+i+" of "+a.length+": "+t),i<a.length||setTimeout(()=>o("loaded",{loaded:!0}),1)},document.body.appendChild(e),r.push(e)}return F(()=>{for(const t of r)console.log("Remove script "+t.src),t.remove();r=[]}),t.$set=(t=>{"dependencies"in t&&n("dependencies",a=t.dependencies)}),{dependencies:a}}class qn extends mt{constructor(t){super(),pt(this,t,Pn,In,l,["dependencies"])}}function An(t){var e,n,o,a,i,r,l,c=t.mapPositions.lat+"",s=t.mapPositions.lon+"",u=t.mapPositions.zoom+"";return{c(){e=x("span"),n=x("span"),o=T(c),a=T(", "),i=T(s),r=T(", "),l=T(u),k(n,"class","map-position"),k(e,"class","right")},m(t,c){w(t,e,c),$(e,n),$(n,o),$(n,a),$(n,i),$(n,r),$(n,l)},p(t,e){t.mapPositions&&c!==(c=e.mapPositions.lat+"")&&L(o,c),t.mapPositions&&s!==(s=e.mapPositions.lon+"")&&L(i,s),t.mapPositions&&u!==(u=e.mapPositions.zoom+"")&&L(l,u)},d(t){t&&y(e)}}}function Bn(e){var n;return{c(){(n=x("span")).textContent="Loading...",k(n,"class","message")},m(t,e){w(t,n,e)},p:t,d(t){t&&y(n)}}}function On(t){var e,n,o,a,i,r,l,c,s,u=new qn({props:{dependencies:t.dependencies}});function d(t,e){return!1===e.loaded?Bn:An}u.$on("loaded",t.mapInit);var p=d(0,t),m=p(t);return{c(){u.$$.fragment.c(),e=E(),n=x("link"),o=E(),a=x("section"),(i=x("div")).innerHTML='<div id="map" style="width: 100%; height: 100%;" class="svelte-1m58pdr"></div>',r=E(),l=x("div"),m.c(),k(n,"href","https://api.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.css"),k(n,"rel","stylesheet"),k(i,"class","section--content"),k(l,"class","section--controls bar controls"),k(l,"id","map-controls"),k(a,"class",c=t.classname+" "+t.view.type)},m(t,c){st(u,t,c),w(t,e,c),$(document.head,n),w(t,o,c),w(t,a,c),$(a,i),$(a,r),$(a,l),m.m(l,null),s=!0},p(t,e){p===(p=d(0,e))&&m?m.p(t,e):(m.d(1),(m=p(e))&&(m.c(),m.m(l,null))),s&&!t.classname&&!t.view||c===(c=e.classname+" "+e.view.type)||k(a,"class",c)},i(t){s||(it(u.$$.fragment,t),s=!0)},o(t){rt(u.$$.fragment,t),s=!1},d(t){ut(u,t),t&&y(e),y(n),t&&(y(o),y(a)),m.d()}}}function Fn(t,e=2){return t.toFixed(e)}function Dn(t,e,n){let{view:o,classname:a}=e;var i;let r={lat:25,lon:30,zoom:1};const l={dark:"mapbox://styles/moriwaan/cjzqsxone04y21ctdxp1dgogb",light:"mapbox://styles/moriwaan/ck3njz1ds2lgm1cqp2poywa3i"};let c=!1,s={visible:!1,threshold:16,elements:[],show:function(){console.log("show()");let t=this.elements;o.content.forEach(function(e){let n=e.properties,o='<li class="card"><a onclick="navi(event)" href="'+n.url+'" data-template="'+n.template+'">';n.thumbnail&&(o+="<figure>"+n.thumbnail+"</figure>"),o+='<div class="title">',o+='<span class="count">'+(n.count||1)+"</span>",o+="<h4>"+n.title+"</h4>",o+="</div>",o+="</a>",o+="</li>";var a=new mapboxgl.Popup({closeOnClick:!1,closeButton:!1,anchor:"bottom-left"}).setLngLat(e.geometry.coordinates).setHTML(o).addTo(i);t.push(a)}),this.visible=!0},hide:function(){for(const t of this.elements)t.remove();this.elements=[],this.visible=!1}};return t.$set=(t=>{"view"in t&&n("view",o=t.view),"classname"in t&&n("classname",a=t.classname)}),{dependencies:["https://api.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.js"],view:o,classname:a,mapPositions:r,loaded:c,mapInit:function(){console.log("mapInit"),mapboxgl.accessToken="pk.eyJ1IjoibW9yaXdhYW4iLCJhIjoiY2l4cnIxNTFvMDAzZjJ3cGJ6MmpiY2ZmciJ9.KnmjmhWCBzMm-D30JdnnXg",(i=new mapboxgl.Map({container:"map",style:l.light,center:[r.lon,r.lat],zoom:r.zoom})).on("load",function(){i.addSource("buildings",{type:"geojson",data:{type:"FeatureCollection",features:o.content},cluster:!0,clusterMaxZoom:7,clusterRadius:24}),i.addLayer({id:"dots",type:"circle",source:"buildings",filter:["==","$type","Point"],paint:{"circle-radius":{base:5,stops:[[2,18],[6,12],[8,5],[10,4],[13,4],[16,8],[22,180]]},"circle-color":"#00f"}}),n("loaded",c=!0)}),i.on("move",function(t){var e=i.getCenter();n("mapPositions",r.lat=Fn(e.lat),r),n("mapPositions",r.lon=Fn(e.lng),r)}),i.on("zoom",function(t){var e=i.getZoom();n("mapPositions",r.zoom=Fn(e,0),r),e>s.threshold&&!1===s.visible?s.show():e<s.threshold&&!0===s.visible&&s.hide()}),i.on("mouseenter","dots",function(){i.getCanvas().style.cursor="pointer"}),i.on("mouseleave","dots",function(){i.getCanvas().style.cursor=""}),i.on("click","dots",function(t){var e=i.queryRenderedFeatures(t.point,{layers:["dots"]});console.log(e[0]);var n=e[0].properties.cluster_id;if(void 0!==n)i.getSource("buildings").getClusterExpansionZoom(n,function(t,n){t||i.easeTo({center:e[0].geometry.coordinates,zoom:n})});else{let t=i.getZoom()+3;t>10&&(t=s.threshold+.2),i.easeTo({center:e[0].geometry.coordinates,zoom:t})}})}}}class Nn extends mt{constructor(t){super(),pt(this,t,Dn,On,l,["view","classname"])}}function Gn(t){var e,n,o,a,i,r,l,c,s,u=t.cameraRotation.x+"",d=t.cameraRotation.y+"",p=t.cameraRotation.z+"";function m(t,e){return!0===e.autoRotate?Jn:Un}var g=m(0,t),f=g(t);return{c(){e=x("span"),f.c(),n=E(),o=x("span"),a=x("span"),i=T(u),r=T(", "),l=T(d),c=T(", "),s=T(p),k(e,"class","left"),k(a,"class","3d-rotation"),k(o,"class","right")},m(t,u){w(t,e,u),f.m(e,null),w(t,n,u),w(t,o,u),$(o,a),$(a,i),$(a,r),$(a,l),$(a,c),$(a,s)},p(t,n){g!==(g=m(0,n))&&(f.d(1),(f=g(n))&&(f.c(),f.m(e,null))),t.cameraRotation&&u!==(u=n.cameraRotation.x+"")&&L(i,u),t.cameraRotation&&d!==(d=n.cameraRotation.y+"")&&L(l,d),t.cameraRotation&&p!==(p=n.cameraRotation.z+"")&&L(s,p)},d(t){t&&y(e),f.d(),t&&(y(n),y(o))}}}function Vn(e){var n;return{c(){(n=x("span")).textContent="Loading ...",k(n,"class","message")},m(t,e){w(t,n,e)},p:t,d(t){t&&y(n)}}}function Un(t){var e,n;return{c(){(e=x("button")).textContent="Rotate",k(e,"class","3d-play"),n=_(e,"click",t.startRotation)},m(t,n){w(t,e,n)},d(t){t&&y(e),n()}}}function Jn(t){var e,n;return{c(){(e=x("button")).textContent="Pause",k(e,"class","3d-pause"),n=_(e,"click",t.stopRotation)},m(t,n){w(t,e,n)},d(t){t&&y(e),n()}}}function Xn(t){var e,n,o,a,i,r,l,c=new qn({props:{dependencies:t.dependencies}});function s(t,e){return 0==e.loaded?Vn:Gn}c.$on("loaded",t.threeInit);var u=s(0,t),d=u(t);return{c(){c.$$.fragment.c(),e=E(),n=x("section"),(o=x("div")).innerHTML='<div id="view-3d"></div>',a=E(),i=x("div"),d.c(),k(o,"class","section--content"),k(i,"class","bar controls section--controls"),k(i,"id","view-3d-controls"),k(n,"class",r=t.classname+" "+t.view.type)},m(t,r){st(c,t,r),w(t,e,r),w(t,n,r),$(n,o),$(n,a),$(n,i),d.m(i,null),l=!0},p(t,e){u===(u=s(0,e))&&d?d.p(t,e):(d.d(1),(d=u(e))&&(d.c(),d.m(i,null))),l&&!t.classname&&!t.view||r===(r=e.classname+" "+e.view.type)||k(n,"class",r)},i(t){l||(it(c.$$.fragment,t),l=!0)},o(t){rt(c.$$.fragment,t),l=!1},d(t){ut(c,t),t&&(y(e),y(n)),d.d()}}}function Zn(t,e,n){let{view:o,classname:a}=e;var i,r,l,c,s,u,d,p=!1,m={x:0,y:0,z:0},g=!0;function f(){u=s.parentElement.offsetWidth,d=s.parentElement.offsetHeight,i.aspect=u/d,i.updateProjectionMatrix(),l.setSize(u,d)}function h(){requestAnimationFrame(h),c.update(),n("cameraRotation",m.x=Math.round(i.position.x),m),n("cameraRotation",m.y=Math.round(i.position.y),m),n("cameraRotation",m.z=Math.round(i.position.z),m),l.render(r,i)}return t.$set=(t=>{"view"in t&&n("view",o=t.view),"classname"in t&&n("classname",a=t.classname)}),{dependencies:["https://documentary-architecture.fra1.digitaloceanspaces.com/cda/assets/js/three.min.js","https://documentary-architecture.fra1.digitaloceanspaces.com/cda/assets/js/inflate.min.js","https://documentary-architecture.fra1.digitaloceanspaces.com/cda/assets/js/FBXLoader.js","https://documentary-architecture.fra1.digitaloceanspaces.com/cda/assets/js/OrbitControls.js"],view:o,classname:a,loaded:p,cameraRotation:m,autoRotate:g,threeInit:function(){s=document.getElementById("view-3d"),u=s.parentElement.offsetWidth,d=s.parentElement.offsetHeight,function(){(i=new THREE.PerspectiveCamera(45,u/d,1,1e4)).position.set(50,50,50),r=new THREE.Scene;var t=new THREE.AmbientLight(13421772,.5);r.add(t);var e=new THREE.PointLight(16777215,.8);i.add(e),r.add(i),(new THREE.FBXLoader).load(o.content.url,function(t){n("loaded",p=!0),r.add(t),c.autoRotate=!0},void 0,function(t){console.error(t)}),(l=new THREE.WebGLRenderer).setPixelRatio(window.devicePixelRatio),l.setSize(u,d),s.appendChild(l.domElement),(c=new THREE.OrbitControls(i,l.domElement)).target.set(0,0,0),c.autoRotate=!1,c.update();var a=new THREE.LineBasicMaterial({color:255}),m=new THREE.Geometry;m.vertices.push(new THREE.Vector3(20,0,0)),m.vertices.push(new THREE.Vector3(0,0,0)),m.vertices.push(new THREE.Vector3(0,20,0)),m.vertices.push(new THREE.Vector3(0,0,0)),m.vertices.push(new THREE.Vector3(0,0,20));var g=new THREE.Line(m,a);r.add(g),window.addEventListener("resize",f,!1)}(),h()},startRotation:function(){console.log("start 3d rotation"),n("autoRotate",g=!0),c.autoRotate=!0},stopRotation:function(){console.log("stop 3d rotation"),n("autoRotate",g=!1),c.autoRotate=!1}}}class Kn extends mt{constructor(t){super(),pt(this,t,Zn,Xn,l,["view","classname"])}}function Yn(t){var e,n,o,a,i,r,l,c=t.cameraRotation.lat+"",s=t.cameraRotation.lon+"";function u(t,e){return!0===e.autoRotate?eo:to}var d=u(0,t),p=d(t);return{c(){e=x("span"),p.c(),n=E(),o=x("span"),a=x("span"),i=T(c),r=T(", "),l=T(s),k(e,"class","left"),k(a,"class","3d-rotation"),k(o,"class","right")},m(t,c){w(t,e,c),p.m(e,null),w(t,n,c),w(t,o,c),$(o,a),$(a,i),$(a,r),$(a,l)},p(t,n){d!==(d=u(0,n))&&(p.d(1),(p=d(n))&&(p.c(),p.m(e,null))),t.cameraRotation&&c!==(c=n.cameraRotation.lat+"")&&L(i,c),t.cameraRotation&&s!==(s=n.cameraRotation.lon+"")&&L(l,s)},d(t){t&&y(e),p.d(),t&&(y(n),y(o))}}}function Qn(e){var n;return{c(){(n=x("span")).textContent="Loading ...",k(n,"class","message")},m(t,e){w(t,n,e)},p:t,d(t){t&&y(n)}}}function to(t){var e,n;return{c(){(e=x("button")).textContent="Rotate",k(e,"class","3d-play"),n=_(e,"click",t.startRotation)},m(t,n){w(t,e,n)},d(t){t&&y(e),n()}}}function eo(t){var e,n;return{c(){(e=x("button")).textContent="Pause",k(e,"class","3d-pause"),n=_(e,"click",t.stopRotation)},m(t,n){w(t,e,n)},d(t){t&&y(e),n()}}}function no(t){var e,n,o,a,i,r,l,c=new qn({props:{dependencies:t.dependencies}});function s(t,e){return 0==e.loaded?Qn:Yn}c.$on("loaded",t.threeInit);var u=s(0,t),d=u(t);return{c(){c.$$.fragment.c(),e=E(),n=x("section"),(o=x("div")).innerHTML='<div id="view-3d"></div>',a=E(),i=x("div"),d.c(),k(o,"class","section--content"),k(i,"class","bar controls section--controls"),k(i,"id","view-3d-controls"),k(n,"class",r=t.classname+" "+t.view.type)},m(t,r){st(c,t,r),w(t,e,r),w(t,n,r),$(n,o),$(n,a),$(n,i),d.m(i,null),l=!0},p(t,e){u===(u=s(0,e))&&d?d.p(t,e):(d.d(1),(d=u(e))&&(d.c(),d.m(i,null))),l&&!t.classname&&!t.view||r===(r=e.classname+" "+e.view.type)||k(n,"class",r)},i(t){l||(it(c.$$.fragment,t),l=!0)},o(t){rt(c.$$.fragment,t),l=!1},d(t){ut(c,t),t&&(y(e),y(n)),d.d()}}}var oo=180;function ao(t,e,n){let{view:o,classname:a,transcript:i}=e;var r,l,c,s,u,d,p,m=!0,g=!1,f=!1,h=0,v=0,$=180,w=180,y=0,b=0,x=0,T=0,E={lat:0,lon:0};function R(){d=u.parentElement.offsetWidth,p=u.parentElement.offsetHeight,r.aspect=d/p,r.updateProjectionMatrix(),c.setSize(d,p)}function _(){requestAnimationFrame(_),function(){!1===f&&!0===m&&($+=.09);y=Math.max(-85,Math.min(85,y)),x=THREE.Math.degToRad(90-y),T=THREE.Math.degToRad($),r.target.x=oo*Math.sin(x)*Math.cos(T),r.target.y=oo*Math.cos(x),r.target.z=oo*Math.sin(x)*Math.sin(T),r.lookAt(r.target),n("cameraRotation",E.lat=Math.round(y),E),n("cameraRotation",E.lon=Math.round($%360-180),E),c.render(l,r)}()}function k(t){t.preventDefault(),f=!0,h=t.clientX,v=t.clientY,w=$,b=y}function L(t){!0===f&&($=.1*(h-t.clientX)+w,y=.1*(t.clientY-v)+b)}function C(t){f=!1}return t.$set=(t=>{"view"in t&&n("view",o=t.view),"classname"in t&&n("classname",a=t.classname),"transcript"in t&&n("transcript",i=t.transcript)}),{dependencies:["https://documentary-architecture.fra1.digitaloceanspaces.com/cda/assets/js/three.min.js","https://documentary-architecture.fra1.digitaloceanspaces.com/cda/assets/js/OrbitControls.js"],view:o,classname:a,transcript:i,autoRotate:m,loaded:g,cameraRotation:E,threeInit:function(){u=document.getElementById("view-3d"),d=u.parentElement.offsetWidth,p=u.parentElement.offsetHeight,function(){(r=new THREE.PerspectiveCamera(100,d/p,1,1100)).target=new THREE.Vector3(20,0,0),l=new THREE.Scene;var t=new THREE.SphereGeometry(oo,60,40);t.scale(-1,1,1);var e=new THREE.MeshBasicMaterial({map:(new THREE.TextureLoader).load(o.content.url,function(){n("loaded",g=!0)},void 0,function(t){console.log("panorama loading error")})});s=new THREE.Mesh(t,e),l.add(s),(c=new THREE.WebGLRenderer).setPixelRatio(window.devicePixelRatio),c.setSize(d,p),u.appendChild(c.domElement),window.addEventListener("resize",R,!1),document.addEventListener("mousedown",k,!1),document.addEventListener("mousemove",L,!1),document.addEventListener("mouseup",C,!1)}(),_()},startRotation:function(){n("autoRotate",m=!0)},stopRotation:function(){n("autoRotate",m=!1)}}}class io extends mt{constructor(t){super(),pt(this,t,ao,no,l,["view","classname","transcript"])}}function ro(t,e,n){const o=Object.create(t);return o.tab=e[n],o}function lo(t){var e;return{c(){k(e=x("div"),"class","is-loading")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function co(t){var e,n,o,a,i,r;let l=t.page.content,c=[];for(let e=0;e<l.length;e+=1)c[e]=so(ro(t,l,e));const s=t=>rt(c[t],1,1,()=>{c[t]=null});return{c(){e=x("main"),n=x("div"),o=x("div");for(let t=0;t<c.length;t+=1)c[t].c();k(o,"class","tabs"),k(n,"class","content"),k(e,"class",a="panel col-sm-"+mo(t.page.entity)),r=_(e,"scroll",t.scrolling,{passive:!0})},m(a,r){w(a,e,r),$(e,n),$(n,o);for(let t=0;t<c.length;t+=1)c[t].m(o,null);t.main_1_binding(e),i=!0},p(t,n){if(t.tabs||t.page){let e;for(l=n.page.content,e=0;e<l.length;e+=1){const a=ro(n,l,e);c[e]?(c[e].p(t,a),it(c[e],1)):(c[e]=so(a),c[e].c(),it(c[e],1),c[e].m(o,null))}for(ot(),e=l.length;e<c.length;e+=1)s(e);at()}i&&!t.page||a===(a="panel col-sm-"+mo(n.page.entity))||k(e,"class",a)},i(t){if(!i){for(let t=0;t<l.length;t+=1)it(c[t]);i=!0}},o(t){c=c.filter(Boolean);for(let t=0;t<c.length;t+=1)rt(c[t]);i=!1},d(n){n&&y(e),b(c,n),t.main_1_binding(null),r()}}}function so(t){var e,n,o=t.tabs[t.tab.type];function a(t){return{props:{tab:t.tab,category:t.page.category,entity:t.page.entity}}}if(o)var i=new o(a(t));return{c(){i&&i.$$.fragment.c(),e=R()},m(t,o){i&&st(i,t,o),w(t,e,o),n=!0},p(t,n){var r={};if(t.page&&(r.tab=n.tab),t.page&&(r.category=n.page.category),t.page&&(r.entity=n.page.entity),o!==(o=n.tabs[n.tab.type])){if(i){ot();const t=i;rt(t.$$.fragment,1,0,()=>{ut(t,1)}),at()}o?((i=new o(a(n))).$$.fragment.c(),it(i.$$.fragment,1),st(i,e.parentNode,e)):i=null}else o&&i.$set(r)},i(t){n||(i&&it(i.$$.fragment,t),n=!0)},o(t){i&&rt(i.$$.fragment,t),n=!1},d(t){t&&y(e),i&&ut(i,t)}}}function uo(t){var e,n,o=t.views[t.page.view.type];function a(t){return{props:{view:t.page.view,classname:"presentation panel col-sm-"+(12-mo(t.page.entity)),transcript:t.page.transcript||!1}}}if(o)var i=new o(a(t));return{c(){i&&i.$$.fragment.c(),e=R()},m(t,o){i&&st(i,t,o),w(t,e,o),n=!0},p(t,n){var r={};if(t.page&&(r.view=n.page.view),t.page&&(r.classname="presentation panel col-sm-"+(12-mo(n.page.entity))),t.page&&(r.transcript=n.page.transcript||!1),o!==(o=n.views[n.page.view.type])){if(i){ot();const t=i;rt(t.$$.fragment,1,0,()=>{ut(t,1)}),at()}o?((i=new o(a(n))).$$.fragment.c(),it(i.$$.fragment,1),st(i,e.parentNode,e)):i=null}else o&&i.$set(r)},i(t){n||(i&&it(i.$$.fragment,t),n=!0)},o(t){i&&rt(i.$$.fragment,t),n=!1},d(t){t&&y(e),i&&ut(i,t)}}}function po(t){var e,n,o,a,i=t.page.loading&&lo(),r=t.page.content&&co(t),l=t.page.view&&uo(t);return{c(){e=x("div"),i&&i.c(),n=E(),r&&r.c(),o=E(),l&&l.c(),k(e,"class","grid panels")},m(t,c){w(t,e,c),i&&i.m(e,null),$(e,n),r&&r.m(e,null),$(e,o),l&&l.m(e,null),a=!0},p(t,a){a.page.loading?i||((i=lo()).c(),i.m(e,n)):i&&(i.d(1),i=null),a.page.content?r?(r.p(t,a),it(r,1)):((r=co(a)).c(),it(r,1),r.m(e,o)):r&&(ot(),rt(r,1,1,()=>{r=null}),at()),a.page.view?l?(l.p(t,a),it(l,1)):((l=uo(a)).c(),it(l,1),l.m(e,null)):l&&(ot(),rt(l,1,1,()=>{l=null}),at())},i(t){a||(it(r),it(l),a=!0)},o(t){rt(r),rt(l),a=!1},d(t){t&&y(e),i&&i.d(),r&&r.d(),l&&l.d()}}}function mo(t){return"file"==t?3:6}function go(t,e,n){let o,a={header:rn,collection:fn,table:Cn,text:Mn},i={collection:De,image:zn,video:xe,audio:_e,map:Nn,"3d":Kn,panorama:io},{page:r}=e;var l=!1,c=!1;return t.$set=(t=>{"page"in t&&n("page",r=t.page)}),{tabs:a,views:i,page:r,main:o,scrolling:function(){(l=o.scrollTop>100)!==c&&(!0===(c=l)?document.body.classList.add("scrolled"):document.body.classList.remove("scrolled"))},main_1_binding:function(t){G[t?"unshift":"push"](()=>{n("main",o=t)})}}}class fo extends mt{constructor(t){super(),pt(this,t,go,po,l,["page"])}}function ho(t,e,n){const o=Object.create(t);return o.item=e[n],o.i=n,o}function vo(t){var e,n=new jt({props:{target:t.pagination.prev,replace:!0,$$slots:{default:[$o]},$$scope:{ctx:t}}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.pagination&&(o.target=e.pagination.prev),t.$$scope&&(o.$$scope={changed:t,ctx:e}),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function $o(t){var e;return{c(){e=T("←")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function wo(t){var e,n;let o=t.pagination.siblings,a=[];for(let e=0;e<o.length;e+=1)a[e]=bo(ho(t,o,e));const i=t=>rt(a[t],1,1,()=>{a[t]=null});return{c(){e=x("ol");for(let t=0;t<a.length;t+=1)a[t].c()},m(t,o){w(t,e,o);for(let t=0;t<a.length;t+=1)a[t].m(e,null);n=!0},p(t,n){if(t.pagination){let r;for(o=n.pagination.siblings,r=0;r<o.length;r+=1){const i=ho(n,o,r);a[r]?(a[r].p(t,i),it(a[r],1)):(a[r]=bo(i),a[r].c(),it(a[r],1),a[r].m(e,null))}for(ot(),r=o.length;r<a.length;r+=1)i(r);at()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)it(a[t]);n=!0}},o(t){a=a.filter(Boolean);for(let t=0;t<a.length;t+=1)rt(a[t]);n=!1},d(t){t&&y(e),b(a,t)}}}function yo(t){var e,n,o,a,i,r=t.i+1+"",l=t.item.title+"";return{c(){e=x("span"),n=T(r),o=E(),a=x("span"),i=T(l),k(e,"class","num"),k(a,"class","title")},m(t,r){w(t,e,r),$(e,n),w(t,o,r),w(t,a,r),$(a,i)},p(t,e){t.pagination&&l!==(l=e.item.title+"")&&L(i,l)},d(t){t&&(y(e),y(o),y(a))}}}function bo(t){var e,n,o,a,i=new jt({props:{target:t.item,replace:!0,$$slots:{default:[yo]},$$scope:{ctx:t}}});return{c(){e=x("li"),i.$$.fragment.c(),n=E(),k(e,"class",o=t.item.url==t.pagination.current.url?"current":"")},m(t,o){w(t,e,o),st(i,e,null),$(e,n),a=!0},p(t,n){var r={};t.pagination&&(r.target=n.item),(t.$$scope||t.pagination)&&(r.$$scope={changed:t,ctx:n}),i.$set(r),a&&!t.pagination||o===(o=n.item.url==n.pagination.current.url?"current":"")||k(e,"class",o)},i(t){a||(it(i.$$.fragment,t),a=!0)},o(t){rt(i.$$.fragment,t),a=!1},d(t){t&&y(e),ut(i)}}}function xo(t){var e,n=new jt({props:{target:t.pagination.parent,$$slots:{default:[Eo]},$$scope:{ctx:t}}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.pagination&&(o.target=e.pagination.parent),t.$$scope&&(o.$$scope={changed:t,ctx:e}),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function To(t){var e,n=new jt({props:{target:t.pagination.next,replace:!0,$$slots:{default:[Ro]},$$scope:{ctx:t}}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.pagination&&(o.target=e.pagination.next),(t.$$scope||t.pagination)&&(o.$$scope={changed:t,ctx:e}),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function Eo(t){var e;return{c(){(e=x("abbr")).textContent="Back",k(e,"title","Back to start")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function Ro(t){var e,n,o;return{c(){e=x("abbr"),n=T("→"),k(e,"title",o="Previous: "+t.pagination.next.title)},m(t,o){w(t,e,o),$(e,n)},p(t,n){t.pagination&&o!==(o="Previous: "+n.pagination.next.title)&&k(e,"title",o)},d(t){t&&y(e)}}}function _o(t){var e,n,o,a,i,r,l=t.pagination.prev&&vo(t),c=t.pagination.siblings&&wo(t),s=[To,xo],u=[];function d(t,e){return e.pagination.next?0:1}return a=d(0,t),i=u[a]=s[a](t),{c(){e=x("nav"),l&&l.c(),n=E(),c&&c.c(),o=E(),i.c(),k(e,"class","pagination bar controls")},m(t,i){w(t,e,i),l&&l.m(e,null),$(e,n),c&&c.m(e,null),$(e,o),u[a].m(e,null),r=!0},p(t,r){r.pagination.prev?l?(l.p(t,r),it(l,1)):((l=vo(r)).c(),it(l,1),l.m(e,n)):l&&(ot(),rt(l,1,1,()=>{l=null}),at()),r.pagination.siblings?c?(c.p(t,r),it(c,1)):((c=wo(r)).c(),it(c,1),c.m(e,o)):c&&(ot(),rt(c,1,1,()=>{c=null}),at());var p=a;(a=d(0,r))===p?u[a].p(t,r):(ot(),rt(u[p],1,1,()=>{u[p]=null}),at(),(i=u[a])||(i=u[a]=s[a](r)).c(),it(i,1),i.m(e,null))},i(t){r||(it(l),it(c),it(i),r=!0)},o(t){rt(l),rt(c),rt(i),r=!1},d(t){t&&y(e),l&&l.d(),c&&c.d(),u[a].d()}}}function ko(t,e,n){let{pagination:o}=e;return t.$set=(t=>{"pagination"in t&&n("pagination",o=t.pagination)}),{pagination:o}}class Lo extends mt{constructor(t){super(),pt(this,t,ko,_o,l,["pagination"])}}function Co(t){var e,n;const o=t.$$slots.default,a=c(o,t,null);return{c(){e=x("section"),a&&a.c(),k(e,"class","tab invitation")},l(t){a&&a.l(section_nodes)},m(t,o){w(t,e,o),a&&a.m(e,null),n=!0},p(t,e){a&&a.p&&t.$$scope&&a.p(u(o,e,t,null),s(o,e,null))},i(t){n||(it(a,t),n=!0)},o(t){rt(a,t),n=!1},d(t){t&&y(e),a&&a.d(t)}}}function Ho(t,e,n){let{$$slots:o={},$$scope:a}=e;return t.$set=(t=>{"$$scope"in t&&n("$$scope",a=t.$$scope)}),{$$slots:o,$$scope:a}}class Wo extends mt{constructor(t){super(),pt(this,t,Ho,Co,l,[])}}function Mo(t){var e;return{c(){k(e=x("div"),"class","is-loading svelte-1kpfqp4")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function So(t){var e,n,o,a,i,r=t.world.help+"",l=t.world.roaming&&Io(t),c=t.world.dollhouse&&Po(t);return{c(){e=x("span"),n=T(r),o=E(),a=x("span"),l&&l.c(),i=E(),c&&c.c(),k(e,"class","message"),k(a,"class","right")},m(t,r){w(t,e,r),$(e,n),w(t,o,r),w(t,a,r),l&&l.m(a,null),$(a,i),c&&c.m(a,null)},p(t,e){t.world&&r!==(r=e.world.help+"")&&L(n,r),e.world.roaming?l?l.p(t,e):((l=Io(e)).c(),l.m(a,i)):l&&(l.d(1),l=null),e.world.dollhouse?c||((c=Po(e)).c(),c.m(a,null)):c&&(c.d(1),c=null)},d(t){t&&(y(e),y(o),y(a)),l&&l.d(),c&&c.d()}}}function jo(t){var e,n,o=t.world.tooltips.item+"";return{c(){e=x("span"),n=T(o),k(e,"class","message")},m(t,o){w(t,e,o),$(e,n)},p(t,e){t.world&&o!==(o=e.world.tooltips.item+"")&&L(n,o)},d(t){t&&y(e)}}}function zo(t){var e,n,o,a,i=t.world.progress+"";return{c(){e=x("span"),n=T("Loading "),o=T(i),a=T("% ... Please wait."),k(e,"class","message")},m(t,i){w(t,e,i),$(e,n),$(e,o),$(e,a)},p(t,e){t.world&&i!==(i=e.world.progress+"")&&L(o,i)},d(t){t&&y(e)}}}function Io(t){var e,n,o,a=t.world.roaming+"";return{c(){e=x("button"),n=T(a),o=_(e,"click",t.click_handler)},m(t,o){w(t,e,o),$(e,n)},p(t,e){t.world&&a!==(a=e.world.roaming+"")&&L(n,a)},d(t){t&&y(e),o()}}}function Po(t){var e,n;return{c(){(e=x("button")).textContent="Overview",n=_(e,"click",t.click_handler_1)},m(t,n){w(t,e,n)},d(t){t&&y(e),n()}}}function qo(t){var e,n,o,a,i,r,l,c,s,u,d,p=new qn({props:{dependencies:t.dependencies}});p.$on("loaded",t.unityInit);var m=!1===t.world.loaded&&Mo();function g(t,e){return!1===e.world.loaded?zo:!1!==e.world.tooltips.item?jo:!1!==e.world.help?So:void 0}var f=g(0,t),h=f&&f(t);return{c(){p.$$.fragment.c(),e=E(),n=x("section"),o=x("div"),a=x("div"),i=E(),m&&m.c(),r=E(),l=x("div"),h&&h.c(),k(a,"id","worldContainer"),k(a,"class","presentation-container"),k(o,"class","section--content svelte-1kpfqp4"),k(o,"id","view-liebling-house"),k(l,"class",c="bar controls section--controls "+(t.world.tooltips.item?"hover":"")+" svelte-1kpfqp4"),k(l,"id","view-liebling-house-controls"),k(n,"class",s=t.classname+" "+t.view.type+" svelte-1kpfqp4"),d=_(a,"click",t.canvasClick)},m(t,c){st(p,t,c),w(t,e,c),w(t,n,c),$(n,o),$(o,a),$(o,i),m&&m.m(o,null),$(n,r),$(n,l),h&&h.m(l,null),u=!0},p(t,e){!1===e.world.loaded?m||((m=Mo()).c(),m.m(o,null)):m&&(m.d(1),m=null),f===(f=g(0,e))&&h?h.p(t,e):(h&&h.d(1),(h=f&&f(e))&&(h.c(),h.m(l,null))),u&&!t.world||c===(c="bar controls section--controls "+(e.world.tooltips.item?"hover":"")+" svelte-1kpfqp4")||k(l,"class",c),u&&!t.classname&&!t.view||s===(s=e.classname+" "+e.view.type+" svelte-1kpfqp4")||k(n,"class",s)},i(t){u||(it(p.$$.fragment,t),u=!0)},o(t){rt(p.$$.fragment,t),u=!1},d(t){ut(p,t),t&&(y(e),y(n)),m&&m.d(),h&&h.d(),d()}}}function Ao(t){switch(t){case"Kiosk":case"Dollhouse":break;default:t="FreeRoaming"}console.log(t),lieblingHouseWorldInstance.SendMessage("GameManager",t)}function Bo(t,e,n){let{view:o,classname:a}=e;const i=[o.content.unityLoader||"https://documentary-architecture.fra1.digitaloceanspaces.com/cda/assets/liebling-house/Build/UnityLoader.js"];console.log(i);var r={loaded:!1,progress:0,tooltips:{item:!1,help:!1},roaming:"Start exploring",dollhouse:!1,help:"Click on the builing to start exploring.",state:"ViewingKiosk",states:{ViewingKiosk:{roaming:!1,dollhouse:!1,help:"Click on the builing to start exploring."},ViewingDollhouse:{roaming:"Continue exploring",dollhouse:!1,help:"Drag to rotate building or click on one of the highlighted spots."},ViewingItem:{roaming:!1,dollhouse:!0,help:"Click to start exploring."},FreeRoaming:{roaming:!1,dollhouse:!0,help:"Use W A S D to navigate and ← ↑ ↓ → to rotate camera."},MovingToItem:{roaming:"Stop",dollhouse:!1,help:!1}}};function l(t,e){t.Module&&(n("world",r.progress=Math.round(100*e),r),1!==e||t.removeTimeout||(t.removeTimeout=setTimeout(function(){n("world",r.loaded=!0,r),console.log("Unity loaded")},3e3)))}F(()=>{lieblingHouseWorldInstance.Quit(function(){console.log("done!")}),lieblingHouseWorldInstance=null}),window.onWorldReady=(()=>{console.log("onWorldReady()"),o.content.worlditemStart?(console.log('could navigate to "'+o.content.worlditemStart+'"'),setTimeout(function(){lieblingHouseWorldInstance.SendMessage("GameManager","TeleportToItem",o.content.worlditemStart)},3001)):Ao("Kiosk")}),window.worldUpdateState=(t=>{console.log("worldUpdateState( "+t+" )"),"ViewingPlatform"!=t&&(n("world",r.state=t,r),n("world",r.roaming=r.states[t].roaming,r),n("world",r.dollhouse=r.states[t].dollhouse,r),n("world",r.help=r.states[t].help,r))}),window.worldHoverItem=(t=>(""==t?n("world",r.tooltips.item=!1,r):(console.log("worldHoverItem( "+t+" )"),n("world",r.tooltips.item=t,r)),!0)),window.worldSelectItem=(t=>""==t?(console.log("worldSelectItem() no selection"),!1):(console.log("worldSelectItem( "+t+" )"),showWorlditemContent(t),!0)),window.worldSelectTourstopOfItem=(t=>""==t?(console.log("worldSelectTourstopOfItem() no selection"),!1):(console.log("worldSelectTourstopOfItem( "+t+" )"),naviFromWorld(t),!0)),window.showWorlditemContent=(async t=>{var e=window.location.origin+"/"+t;console.log("showWorlditemContent()",e),Wt(e,{},!0)}),window.goThroughGlass=(t=>{console.log("went through glass"),Ao("FreeRoaming")}),window.goToItem=(t=>{console.log("goToItem("+t+")"),lieblingHouseWorldInstance.SendMessage("GameManager","GoToItem",t)}),window.teleportToItem=(t=>{console.log("teleportToItem("+t+")"),lieblingHouseWorldInstance.SendMessage("GameManager","TeleportToItem",t)}),window.worldSetState=(t=>{Ao(t)});return t.$set=(t=>{"view"in t&&n("view",o=t.view),"classname"in t&&n("classname",a=t.classname)}),{view:o,classname:a,dependencies:i,world:r,unityInit:function(){lieblingHouseWorldContainer=document.getElementById("worldContainer"),lieblingHouseWorldInstance=UnityLoader.instantiate(lieblingHouseWorldContainer,o.content.unityJson,{onProgress:l})},canvasClick:function(){"FreeRoaming "!==r.state&&Ao("FreeRoaming")},click_handler:()=>Ao("FreeRoaming"),click_handler_1:()=>Ao("Dollhouse")}}class Oo extends mt{constructor(t){super(),pt(this,t,Bo,qo,l,["view","classname"])}}function Fo(t,e,n){const o=Object.create(t);return o.tab=e[n],o}function Do(t){var e,n,o,a,r,l,c,s,u,d,p=t.page.loading&&No(),m=[Uo,Vo,Go],g=[];function f(t,e){return"overview"==e.page.category?0:"tour"==e.page.category?1:"tourstop"==e.page.category&&e.page.pagination?2:-1}~(r=f(0,t))&&(l=g[r]=m[r](t));let h=t.page.content,v=[];for(let e=0;e<h.length;e+=1)v[e]=Ko(Fo(t,h,e));const T=t=>rt(v[t],1,1,()=>{v[t]=null});return{c(){e=x("main"),n=x("div"),o=x("div"),p&&p.c(),a=E(),l&&l.c(),c=E();for(let t=0;t<v.length;t+=1)v[t].c();k(o,"class","tabs"),k(n,"class","content"),k(e,"class",s="panel col-sm-3 "+t.page.category),d=[_(e,"click",t.window.touchGlass),_(e,"scroll",t.scrolling,{passive:!0})]},m(i,l){w(i,e,l),$(e,n),$(n,o),p&&p.m(o,null),$(o,a),~r&&g[r].m(o,null),$(o,c);for(let t=0;t<v.length;t+=1)v[t].m(o,null);t.main_binding(e),u=!0},p(t,n){n.page.loading?p||((p=No()).c(),p.m(o,a)):p&&(p.d(1),p=null);var i=r;if((r=f(0,n))===i?~r&&g[r].p(t,n):(l&&(ot(),rt(g[i],1,1,()=>{g[i]=null}),at()),~r?((l=g[r])||(l=g[r]=m[r](n)).c(),it(l,1),l.m(o,c)):l=null),t.tabs||t.page){let e;for(h=n.page.content,e=0;e<h.length;e+=1){const a=Fo(n,h,e);v[e]?(v[e].p(t,a),it(v[e],1)):(v[e]=Ko(a),v[e].c(),it(v[e],1),v[e].m(o,null))}for(ot(),e=h.length;e<v.length;e+=1)T(e);at()}u&&!t.page||s===(s="panel col-sm-3 "+n.page.category)||k(e,"class",s)},i(t){if(!u){it(l);for(let t=0;t<h.length;t+=1)it(v[t]);u=!0}},o(t){rt(l),v=v.filter(Boolean);for(let t=0;t<v.length;t+=1)rt(v[t]);u=!1},d(n){n&&y(e),p&&p.d(),~r&&g[r].d(),b(v,n),t.main_binding(null),i(d)}}}function No(t){var e;return{c(){k(e=x("div"),"class","is-loading")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function Go(t){var e,n=new Lo({props:{pagination:t.page.pagination}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.page&&(o.pagination=e.page.pagination),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function Vo(t){var e,n=new Wo({props:{$$slots:{default:[Xo]},$$scope:{ctx:t}}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};(t.$$scope||t.page)&&(o.$$scope={changed:t,ctx:e}),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function Uo(t){var e,n=new Wo({props:{$$slots:{default:[Zo]},$$scope:{ctx:t}}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.$$scope&&(o.$$scope={changed:t,ctx:e}),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function Jo(t){var e;return{c(){e=T("Start promenade →")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function Xo(t){var e,n=new jt({props:{target:t.page.content[1].content[0],class:"button blue",$$slots:{default:[Jo]},$$scope:{ctx:t}}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.page&&(o.target=e.page.content[1].content[0]),t.$$scope&&(o.$$scope={changed:t,ctx:e}),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function Zo(e){var n,o;return{c(){(n=x("button")).textContent="Start exploring →",k(n,"class","blue"),o=_(n,"click",e.window.worldSetRoaming)},m(t,e){w(t,n,e)},p:t,d(t){t&&y(n),o()}}}function Ko(t){var e,n,o=t.tabs[t.tab.type];function a(t){return{props:{tab:t.tab,category:t.page.category,entity:t.page.entity}}}if(o)var i=new o(a(t));return{c(){i&&i.$$.fragment.c(),e=R()},m(t,o){i&&st(i,t,o),w(t,e,o),n=!0},p(t,n){var r={};if(t.page&&(r.tab=n.tab),t.page&&(r.category=n.page.category),t.page&&(r.entity=n.page.entity),o!==(o=n.tabs[n.tab.type])){if(i){ot();const t=i;rt(t.$$.fragment,1,0,()=>{ut(t,1)}),at()}o?((i=new o(a(n))).$$.fragment.c(),it(i.$$.fragment,1),st(i,e.parentNode,e)):i=null}else o&&i.$set(r)},i(t){n||(i&&it(i.$$.fragment,t),n=!0)},o(t){i&&rt(i.$$.fragment,t),n=!1},d(t){t&&y(e),i&&ut(i,t)}}}function Yo(t){var e,n=new Oo({props:{view:t.page.view,classname:"presentation panel col-12"}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.page&&(o.view=e.page.view),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function Qo(t){var e,n,o,a=t.page.content&&Do(t),i=t.page.view&&Yo(t);return{c(){e=x("div"),a&&a.c(),n=E(),i&&i.c(),k(e,"class","grid panels overlap")},m(t,r){w(t,e,r),a&&a.m(e,null),$(e,n),i&&i.m(e,null),o=!0},p(t,o){o.page.content?a?(a.p(t,o),it(a,1)):((a=Do(o)).c(),it(a,1),a.m(e,n)):a&&(ot(),rt(a,1,1,()=>{a=null}),at()),o.page.view?i?(i.p(t,o),it(i,1)):((i=Yo(o)).c(),it(i,1),i.m(e,null)):i&&(ot(),rt(i,1,1,()=>{i=null}),at())},i(t){o||(it(a),it(i),o=!0)},o(t){rt(a),rt(i),o=!1},d(t){t&&y(e),a&&a.d(),i&&i.d()}}}function ta(t,e,n){let o,a={header:rn,collection:fn,table:Cn,text:Mn},{page:i}=e;window.touchGlass=(t=>"liebling-house"===i.view.type&&(t.target===o&&void window.goThroughGlass()));var r=!1,l=!1;return document.body.classList.add("liebling-house"),F(()=>{document.body.classList.remove("liebling-house")}),t.$set=(t=>{"page"in t&&n("page",i=t.page)}),{tabs:a,page:i,glass:o,scrolling:function(){(r=o.scrollTop>100)!==l&&(!0===(l=r)?document.body.classList.add("scrolled"):document.body.classList.remove("scrolled"))},window:window,main_binding:function(t){G[t?"unshift":"push"](()=>{n("glass",o=t)})}}}class ea extends mt{constructor(t){super(),pt(this,t,ta,Qo,l,["page"])}}async function na(t){xt({...t,loading:!0}),$t.update(t=>(t.pop(),t)),xt({...await kt(t.url),loading:!1})}async function oa(t){if(!t.state)throw Error("popState() no history.state object");console.log("popState("+t.state.url+")"),na(t.state)}function aa(t){let e=t.target.closest("a");e&&e.classList.contains("follow")&&(t.preventDefault(),Ct(e.href))}function ia(e){var n;return{c(){k(n=x("div"),"class","is-loading")},m(t,e){w(t,n,e)},p:t,i:t,o:t,d(t){t&&y(n)}}}function ra(t){var e,n=new tn({props:{page:t.page}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.page&&(o.page=e.page),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function la(t){var e,n,o,a,i=[ua,sa],r=[];function l(t,e){return e.page.view&&"liebling-house"===e.page.view.type?0:1}e=l(0,t),n=r[e]=i[e](t);var c=new Gt({props:{page:t.page}});return{c(){n.c(),o=E(),c.$$.fragment.c()},m(t,n){r[e].m(t,n),w(t,o,n),st(c,t,n),a=!0},p(t,a){var s=e;(e=l(0,a))===s?r[e].p(t,a):(ot(),rt(r[s],1,1,()=>{r[s]=null}),at(),(n=r[e])||(n=r[e]=i[e](a)).c(),it(n,1),n.m(o.parentNode,o));var u={};t.page&&(u.page=a.page),c.$set(u)},i(t){a||(it(n),it(c.$$.fragment,t),a=!0)},o(t){rt(n),rt(c.$$.fragment,t),a=!1},d(t){r[e].d(t),t&&y(o),ut(c,t)}}}function ca(e){var n,o=e.page.html+"";return{c(){n=x("div")},m(t,e){w(t,n,e),n.innerHTML=o},p(t,e){t.page&&o!==(o=e.page.html+"")&&(n.innerHTML=o)},i:t,o:t,d(t){t&&y(n)}}}function sa(t){var e,n=new fo({props:{page:t.page}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.page&&(o.page=e.page),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function ua(t){var e,n=new ea({props:{page:t.page}});return{c(){n.$$.fragment.c()},m(t,o){st(n,t,o),e=!0},p(t,e){var o={};t.page&&(o.page=e.page),n.$set(o)},i(t){e||(it(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function da(t){var e,n,o,a,r,l,c,s;document.title=e="CDA "+t.page.title;var u=new At({}),d=[ca,la,ra,ia],p=[];function m(t,e){return"html"===e.page.template?0:"entity"===e.page.template?1:"archive"===e.page.template?2:e.page.loading?3:-1}return~(a=m(0,t))&&(r=p[a]=d[a](t)),{c(){n=E(),u.$$.fragment.c(),o=E(),r&&r.c(),l=R(),s=[_(window,"popstate",oa),_(window,"click",aa)]},m(t,e){w(t,n,e),st(u,t,e),w(t,o,e),~a&&p[a].m(t,e),w(t,l,e),c=!0},p(t,n){c&&!t.page||e===(e="CDA "+n.page.title)||(document.title=e);var o=a;(a=m(0,n))===o?~a&&p[a].p(t,n):(r&&(ot(),rt(p[o],1,1,()=>{p[o]=null}),at()),~a?((r=p[a])||(r=p[a]=d[a](n)).c(),it(r,1),r.m(l.parentNode,l)):r=null)},i(t){c||(it(u.$$.fragment,t),it(r),c=!0)},o(t){rt(u.$$.fragment,t),rt(r),c=!1},d(t){t&&y(n),ut(u,t),t&&y(o),~a&&p[a].d(t),t&&y(l),i(s)}}}function pa(t,e,n){var o;o=(async()=>{!async function(t=!1,e=!1){let n=Et({title:e||document.title.replace("CDA ",""),url:t||window.location.href,template:Rt(window.location.pathname)});xt({...n,loading:!0}),wt(n);let o=await kt(n.url);o.html?(o.url=n.url,o.title=n.title,o.template="html"):n=Et(o),xt({...o,loading:!1}),history.replaceState(n,n.title,n.url),yt(n)}()}),B().$$.on_mount.push(o);let a={};bt.subscribe(t=>{for(var e in t)t[e]!==a[e]&&n("page",a[e]=t[e],a);console.log(a)});return{page:a}}return console.log("CDA Centre for Documentary Architecture"),new class extends mt{constructor(t){super(),pt(this,t,pa,da,l,[])}}({target:document.querySelector("#frontend")})}();
//# sourceMappingURL=bundle.js.map
